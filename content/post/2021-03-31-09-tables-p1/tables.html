---
title: "09: APA Tables Part 1"
author: "Emorie D Beck"
date: "April 23, 2020"
output:
  html_document:
    theme: united
    highlight: tango
    df_print: paged
    code_folding: show
    toc: true
    toc_float: true
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<div id="workspace" class="section level1">
<h1>Workspace</h1>
<div id="packages" class="section level2">
<h2>Packages</h2>
<pre class="r code-style"><code>library(knitr)
library(lme4)
library(kableExtra)
library(psych)
library(broom)
library(plyr)
library(tidyverse)</code></pre>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>The data we’re going to use are from the teaching sample from the German Socioeconomic Panel Study. These data have been pre-cleaned (see earlier workshop on workflow and creating guidelines for tips).</p>
<p>The data we’ll use fall into three categories:<br />
1. <strong>Personality trait composites:</strong> Negative Affect, Positive Affect, Self-Esteem, CESD Depression, and Optimism. These were cleaned, reversed coded, and composited prior to being included in this final data set.<br />
2. <strong>Outcomes:</strong> Moving in with a partner, marriage, divorce, and child birth. These were cleaned, coded as 1 (occurred) or 0 (did not occur) according to whether an outcome occurred for each individual or not <em>after</em> each possible measured personality year. Moreover, people who experienced these outcomes prior to the target personality year are excluded.<br />
3. <strong>Covariates:</strong> Age, gender (0 = male, 1 = female, education (0 = high school or below, 1 = college, 2 = higher than college), gross wages, self-rated health, smoking (0 = never smoked 1 = ever smoked), exercise, BMI, religion, parental education, and parental occupational prestige (ISEI). Each of these were composited for all available data up to the measured personality years.</p>
<p>First, the code below will download a .zip file when you run it. Once, you do, navigate to your Desktop to unzip the folder. You should now be able to run the rest of the code.</p>
<pre class="r code-style"><code>data_source &lt;- &quot;https://github.com/emoriebeck/R-tutorials/raw/master/09_tables-p1/09_tables-p1.zip&quot;
data_dest &lt;- &quot;~/Desktop/09_tables-p1.zip&quot;
download.file(data_source, data_dest)
unzip(data_dest, exdir = &quot;~/Desktop&quot;)</code></pre>
<pre class="r code-style"><code>wd &lt;- &quot;~/Desktop/tables&quot;
(gsoep &lt;- sprintf(&quot;%s/data/gsoep.csv&quot;, wd) %&gt;% read_csv())</code></pre>
<pre><code>## # A tibble: 329,651 x 21
##    p_year   SID Outcome   o_value Trait p_value   age education gender grsWages
##     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1   2005   901 chldbrth        0 OP          4    33        NA      1   13597.
##  2   2005   901 divorced        0 OP          4    33        NA      1   13597.
##  3   2005   901 married         0 OP          4    33        NA      1   13597.
##  4   2005   901 mvInPrtnr       0 OP          4    33        NA      1   13597.
##  5   2005  1202 chldbrth        0 OP          2    71        NA      1    3900.
##  6   2005  1202 divorced        0 OP          2    71        NA      1    3900.
##  7   2005  1202 mvInPrtnr       0 OP          2    71        NA      1    3900.
##  8   2005  2301 chldbrth        0 OP          3    38        NA      0   33429.
##  9   2005  2301 divorced        0 OP          3    38        NA      0   33429.
## 10   2005  2301 mvInPrtnr       1 OP          3    38        NA      0   33429.
## # … with 329,641 more rows, and 11 more variables: physhlthevnt &lt;dbl&gt;,
## #   SRhealth &lt;dbl&gt;, smokes &lt;dbl&gt;, exercise &lt;dbl&gt;, BMI &lt;dbl&gt;, married &lt;dbl&gt;,
## #   numKids &lt;dbl&gt;, PhysFunc &lt;dbl&gt;, religion &lt;dbl&gt;, parEdu &lt;dbl&gt;,
## #   parOccPrstg &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="apa-tables" class="section level1">
<h1>APA Tables</h1>
<p>In psychology, we must work within the confines of APA style. Although these guidelines have been updated, the style guide remains quite similar to earlier guidelines with respect to tables.</p>
<p>But psychology research is heterogeneous and expectations for modern tables require combining multiple models in creative ways.</p>
<p>Small tweaks to data or model arguments can spell disaster for creating a table. It’s easy to make mistakes in copying values or matching different models to their respective rows and columns.</p>
<p>Thankfully, the increasing popularity of R has been coupled with more methods for creating a reproducible workflow that includes tables.</p>
</div>
<div id="outline" class="section level1">
<h1>Outline</h1>
<p>In this tutorial, we will directly cover 3 different use cases, while a few others will be included in supplementary materials.</p>
<p>Personally, I favor non-automated tools, so we will cover the following packages:<br />
- <code>kable</code> + <code>kableExtra</code> (<a href="http://haozhu233.github.io/kableExtra/awesome_table_in_html.html">html</a> and <a href="https://haozhu233.github.io/kableExtra/awesome_table_in_pdf.pdf">LaTeX</a>)<br />
- <a href ="https://github.com/crsh/papaja"><code>papaja</code></a></p>
<p>Using these packages will build on earlier tutorials using <code>tidyr</code>, <code>dplyr</code>, workflow, and <code>purrr</code> and round out our discuss on data presentation using <code>ggplot2</code>.</p>
<p>For less flexible but more accessible tables see:<br />
- <a href="https://cran.r-project.org/web/packages/apaTables/vignettes/apaTables.html"><code>apaTable</code></a><br />
- <a href="http://www.strengejacke.de/sjPlot/"><code>sjPlot</code></a><br />
- <a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html"><code>corrplot</code></a></p>
<div id="important-tools" class="section level2">
<h2>Important Tools</h2>
<p>Although it doesn’t cover all models, the <code>broom</code> and <code>broom.mixed</code> family of packages will provide easy to work with estimates of nearly all types of models and will also provide the model terms that are ideal for most APA tables, including estimates, standard errors, and confidence intervals.</p>
<p><code>lavaan</code> models are slightly more complicated, but it’s actually relatively easy to deal with them (and how to extract their terms), assuming that you understand the models you are running.</p>
</div>
</div>
<div id="basic-lessons-one-dvoutcome-multiple-model-terms" class="section level1">
<h1>Basic Lessons: One DV/Outcome, Multiple Model Terms</h1>
<p>We’ll start with a basic case, predicting who has a child from personality, both with and without control variables.</p>
<p>Becauce outcome variables are binary, we’ll use logistic regression.</p>
<p>The basic form of the model is: <span class="math inline">\(\log\Big(\frac{p_i}{1-p_i}\Big) = b_0 + b_1X_1 + b_2X_2 ... b_pXp\)</span></p>
<p>In other words, we’re predicting the log odds of having a child from a linear combination of predictor variables.</p>
<div id="set-up-the-data-frame" class="section level2">
<h2>Set up the data frame</h2>
<p>First, we’ll use some of what we learned in the <code>purrr</code> workshop to set ourselves up to be able to create these tables easily, using <code>group_by()</code> and <code>nest()</code> to create nested data frames for our target personality + outcome combinations. To do this, we’ll also use what you learned about <code>filter()</code> and <code>mutate()</code>.</p>
<pre class="r code-style"><code>gsoep_nested1 &lt;- gsoep %&gt;%
  filter(Outcome == &quot;chldbrth&quot;) %&gt;%
  group_by(Trait, Outcome) %&gt;%
  nest() %&gt;%
  ungroup()
gsoep_nested1</code></pre>
<pre><code>## # A tibble: 5 x 3
##   Outcome  Trait  data                  
##   &lt;chr&gt;    &lt;chr&gt;  &lt;list&gt;                
## 1 chldbrth OP     &lt;tibble [9,192 × 19]&gt; 
## 2 chldbrth DEP    &lt;tibble [28,634 × 19]&gt;
## 3 chldbrth NegAff &lt;tibble [16,992 × 19]&gt;
## 4 chldbrth PA     &lt;tibble [16,969 × 19]&gt;
## 5 chldbrth SE     &lt;tibble [7,934 × 19]&gt;</code></pre>
<p>First, let’s pause and see what we have. We now have a data frame with 3 columns (Outcome, Trait, and data) and 4 rows. The data column is of class list, meaning it’s a “list column” that contains a <code>tibble</code> in each cell. This means that we can use <code>purrr</code> functions to run operations on each of these data frames individually but without having to copy and paste the same operation multiple times for each model we want to run.</p>
</div>
<div id="run-models" class="section level2">
<h2>Run Models</h2>
<p>To run the models, I like to write short functions that are easier to read than including a local function within a call to <code>purrr::map()</code>. Here, we’re just going to write a simple function to predict child birth from personality.</p>
<pre class="r code-style"><code>mod1_fun &lt;- function(d){
  d$o_value &lt;- factor(d$o_value)
  glm(o_value ~ p_value, data = d, family = binomial(link = &quot;logit&quot;))
}

gsoep_nested1 &lt;- gsoep_nested1 %&gt;%
  mutate(m = map(data, mod1_fun))
gsoep_nested1</code></pre>
<pre><code>## # A tibble: 5 x 4
##   Outcome  Trait  data                   m     
##   &lt;chr&gt;    &lt;chr&gt;  &lt;list&gt;                 &lt;list&gt;
## 1 chldbrth OP     &lt;tibble [9,192 × 19]&gt;  &lt;glm&gt; 
## 2 chldbrth DEP    &lt;tibble [28,634 × 19]&gt; &lt;glm&gt; 
## 3 chldbrth NegAff &lt;tibble [16,992 × 19]&gt; &lt;glm&gt; 
## 4 chldbrth PA     &lt;tibble [16,969 × 19]&gt; &lt;glm&gt; 
## 5 chldbrth SE     &lt;tibble [7,934 × 19]&gt;  &lt;glm&gt;</code></pre>
<p>Now, when we look at the nested frame, we see an additional column, which is also a list, but this column contains <code>&lt;glm&gt;</code> objects rather than <code>tibbles</code>.</p>
</div>
<div id="get-key-terms" class="section level2">
<h2>Get Key Terms</h2>
<p>Now that we have the models, we want to get our key terms. I’m a big fan of using the function <code>tidy</code> from the <code>broom</code> package to do this. Bonus because it plays nicely with <code>purrr</code>. Double bonus because it will give us confidence intervals, which I generally prefer over p-values and standard erorrs because I find them more informative.</p>
<pre class="r code-style"><code>gsoep_nested1 &lt;- gsoep_nested1 %&gt;%
  mutate(tidy = map(m, ~tidy(., conf.int = T)))
gsoep_nested1</code></pre>
<pre><code>## # A tibble: 5 x 5
##   Outcome  Trait  data                   m      tidy            
##   &lt;chr&gt;    &lt;chr&gt;  &lt;list&gt;                 &lt;list&gt; &lt;list&gt;          
## 1 chldbrth OP     &lt;tibble [9,192 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 2 chldbrth DEP    &lt;tibble [28,634 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 3 chldbrth NegAff &lt;tibble [16,992 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 4 chldbrth PA     &lt;tibble [16,969 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 5 chldbrth SE     &lt;tibble [7,934 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;</code></pre>
<p>Note that what I’ve used here is a local function, meaning that I’ve used the notation <code>~</code>function(., arguments). The tilda tells <code>R</code> we want a local function, and the <code>.</code> tells R to use the mapped <code>m</code> column as the function input.</p>
<p>Now we have a fifth column, which is a list column called <code>tidy</code> that contains a <code>tibble</code>, just like the <code>data</code> column.</p>
</div>
<div id="creating-a-table" class="section level2">
<h2>Creating a Table</h2>
<p>Now we are finally ready to create a table! I’m going to use <code>kable</code> + <code>kableExtra</code> to do this in steps.</p>
<p>First, we’ll unnest the <code>tidy</code> column from our data frame. Before doing so, we will drop the <code>data</code> and <code>m</code> columns because they’ve done their work for now.</p>
<pre class="r code-style"><code>tidy1 &lt;- gsoep_nested1 %&gt;%
  select(-data, -m) %&gt;%
  unnest(tidy)
tidy1</code></pre>
<pre><code>## # A tibble: 10 x 9
##    Outcome Trait term  estimate std.error statistic   p.value conf.low conf.high
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1 chldbr… OP    (Int…  -4.30      0.186     -23.1  1.84e-118  -4.67      -3.94 
##  2 chldbr… OP    p_va…   0.518     0.0582      8.90 5.53e- 19   0.405      0.633
##  3 chldbr… DEP   (Int…  -3.48      0.146     -23.8  3.86e-125  -3.76      -3.19 
##  4 chldbr… DEP   p_va…   0.143     0.0364      3.92 9.00e-  5   0.0716     0.214
##  5 chldbr… NegA… (Int…  -3.58      0.132     -27.2  2.43e-163  -3.84      -3.33 
##  6 chldbr… NegA… p_va…   0.107     0.0471      2.27 2.33e-  2   0.0142     0.199
##  7 chldbr… PA    (Int…  -5.79      0.219     -26.5  1.64e-154  -6.23      -5.37 
##  8 chldbr… PA    p_va…   0.677     0.0554     12.2  2.91e- 34   0.569      0.786
##  9 chldbr… SE    (Int…  -4.11      0.342     -12.0  2.79e- 33  -4.80      -3.46 
## 10 chldbr… SE    p_va…   0.0853    0.0583      1.46 1.43e-  1  -0.0264     0.202</code></pre>
<p>As you can see, we now have lots of information about our model terms, which are already nicely indexed by Outcome and Trait combinations.</p>
<p>But before we’re ready to create a table, we have to make a few considerations:
- What is our target term? In this case “p_value” which is the change in log odds associated with a 1 unit increase/decrease in p_value.</p>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;% filter(term == &quot;p_value&quot;)
tidy1</code></pre>
<pre><code>## # A tibble: 5 x 9
##   Outcome  Trait term   estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 chldbrth OP    p_val…   0.518     0.0582      8.90 5.53e-19   0.405      0.633
## 2 chldbrth DEP   p_val…   0.143     0.0364      3.92 9.00e- 5   0.0716     0.214
## 3 chldbrth NegA… p_val…   0.107     0.0471      2.27 2.33e- 2   0.0142     0.199
## 4 chldbrth PA    p_val…   0.677     0.0554     12.2  2.91e-34   0.569      0.786
## 5 chldbrth SE    p_val…   0.0853    0.0583      1.46 1.43e- 1  -0.0264     0.202</code></pre>
<ul>
<li>How will we denote significance? In this case, we’ll use confidence intervals whose signs match. We’ll then bold these terms for our table.</li>
</ul>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;% mutate(sig = ifelse(sign(conf.low) == sign(conf.high), &quot;sig&quot;, &quot;ns&quot;))
tidy1</code></pre>
<pre><code>## # A tibble: 5 x 10
##   Outcome  Trait term   estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 chldbrth OP    p_val…   0.518     0.0582      8.90 5.53e-19   0.405      0.633
## 2 chldbrth DEP   p_val…   0.143     0.0364      3.92 9.00e- 5   0.0716     0.214
## 3 chldbrth NegA… p_val…   0.107     0.0471      2.27 2.33e- 2   0.0142     0.199
## 4 chldbrth PA    p_val…   0.677     0.0554     12.2  2.91e-34   0.569      0.786
## 5 chldbrth SE    p_val…   0.0853    0.0583      1.46 1.43e- 1  -0.0264     0.202
## # … with 1 more variable: sig &lt;chr&gt;</code></pre>
<ul>
<li>What is the desired final structure for the table? I’d like columns for Trait, estimate (b), and confidence intervals (CI) formatted to two decimal places and bolded if significant. I’d also like a span header denoting that the outcome measure is child birth.</li>
</ul>
<p>Before we do this, though, we need to convert our log odds to odds ratios, using the <code>exp()</code> function.</p>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), exp) 
tidy1</code></pre>
<pre><code>## # A tibble: 5 x 10
##   Outcome  Trait term   estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 chldbrth OP    p_val…     1.68    0.0582      8.90 5.53e-19    1.50       1.88
## 2 chldbrth DEP   p_val…     1.15    0.0364      3.92 9.00e- 5    1.07       1.24
## 3 chldbrth NegA… p_val…     1.11    0.0471      2.27 2.33e- 2    1.01       1.22
## 4 chldbrth PA    p_val…     1.97    0.0554     12.2  2.91e-34    1.77       2.20
## 5 chldbrth SE    p_val…     1.09    0.0583      1.46 1.43e- 1    0.974      1.22
## # … with 1 more variable: sig &lt;chr&gt;</code></pre>
<p>Now, we can format them.</p>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), ~sprintf(&quot;%.2f&quot;, .)) 
tidy1</code></pre>
<pre><code>## # A tibble: 5 x 10
##   Outcome  Trait term   estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    
## 1 chldbrth OP    p_val… 1.68        0.0582      8.90 5.53e-19 1.50     1.88     
## 2 chldbrth DEP   p_val… 1.15        0.0364      3.92 9.00e- 5 1.07     1.24     
## 3 chldbrth NegA… p_val… 1.11        0.0471      2.27 2.33e- 2 1.01     1.22     
## 4 chldbrth PA    p_val… 1.97        0.0554     12.2  2.91e-34 1.77     2.20     
## 5 chldbrth SE    p_val… 1.09        0.0583      1.46 1.43e- 1 0.97     1.22     
## # … with 1 more variable: sig &lt;chr&gt;</code></pre>
<p><code>sprintf()</code> is my favorite base <code>R</code> formatting function. “%.2f” means I’m asking it to take a floating point number and include 2 digits after the “.” and 0 before. We can now see that the <code>estimate</code>, <code>conf.low</code>, and <code>conf.high</code> columns are of class <code>&lt;chr&gt;</code> instead of <code>&lt;dbl&gt;</code>.</p>
<p>But now we need to create our confidence intervals.</p>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;%
  mutate(CI = sprintf(&quot;[%s, %s]&quot;, conf.low, conf.high))
tidy1</code></pre>
<pre><code>## # A tibble: 5 x 11
##   Outcome  Trait term   estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    
## 1 chldbrth OP    p_val… 1.68        0.0582      8.90 5.53e-19 1.50     1.88     
## 2 chldbrth DEP   p_val… 1.15        0.0364      3.92 9.00e- 5 1.07     1.24     
## 3 chldbrth NegA… p_val… 1.11        0.0471      2.27 2.33e- 2 1.01     1.22     
## 4 chldbrth PA    p_val… 1.97        0.0554     12.2  2.91e-34 1.77     2.20     
## 5 chldbrth SE    p_val… 1.09        0.0583      1.46 1.43e- 1 0.97     1.22     
## # … with 2 more variables: sig &lt;chr&gt;, CI &lt;chr&gt;</code></pre>
<p>And bold the significant confidence intervals and estimates.</p>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;%
  mutate_at(vars(estimate, CI), ~ifelse(sig == &quot;sig&quot;, sprintf(&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;, .), .))
tidy1</code></pre>
<pre><code>## # A tibble: 5 x 11
##   Outcome  Trait term  estimate  std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    
## 1 chldbrth OP    p_va… &lt;strong&gt;…    0.0582      8.90 5.53e-19 1.50     1.88     
## 2 chldbrth DEP   p_va… &lt;strong&gt;…    0.0364      3.92 9.00e- 5 1.07     1.24     
## 3 chldbrth NegA… p_va… &lt;strong&gt;…    0.0471      2.27 2.33e- 2 1.01     1.22     
## 4 chldbrth PA    p_va… &lt;strong&gt;…    0.0554     12.2  2.91e-34 1.77     2.20     
## 5 chldbrth SE    p_va… 1.09         0.0583      1.46 1.43e- 1 0.97     1.22     
## # … with 2 more variables: sig &lt;chr&gt;, CI &lt;chr&gt;</code></pre>
<p>This reads as “for both the estimate and the CI columns, if the sig column is equal to”sig“, then let’s format it as bold using html. Otherwise, let’s leave it alone.” And indeed, we can see that the final result formats 3/4 rows.</p>
<p>Thankfully, these can be achieved without considerable reshaping of the data, which is why we’ve started here, so we’re almost done. We just need to get rid of some unnecessary columnns.</p>
<pre class="r code-style"><code>tidy1 &lt;- tidy1 %&gt;%
  select(Trait, OR = estimate, CI)</code></pre>
<p>Because we just have one target term and one outcome, we don’t need those columns, so we’re just keeping Trait, OR, which I renamed as such within in the select call, and CI.</p>
<p>Now let’s <code>kable</code>. You’ve likely used the <code>kable()</code> function from the <code>knitr</code> before. It’s a very useful and simple function in most occasions.</p>
<pre class="r code-style"><code>kable(tidy1)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Trait
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OP
</td>
<td style="text-align:left;">
&lt;strong&gt;1.68&lt;/strong&gt;
</td>
<td style="text-align:left;">
&lt;strong&gt;[1.50, 1.88]&lt;/strong&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
DEP
</td>
<td style="text-align:left;">
&lt;strong&gt;1.15&lt;/strong&gt;
</td>
<td style="text-align:left;">
&lt;strong&gt;[1.07, 1.24]&lt;/strong&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
NegAff
</td>
<td style="text-align:left;">
&lt;strong&gt;1.11&lt;/strong&gt;
</td>
<td style="text-align:left;">
&lt;strong&gt;[1.01, 1.22]&lt;/strong&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
PA
</td>
<td style="text-align:left;">
&lt;strong&gt;1.97&lt;/strong&gt;
</td>
<td style="text-align:left;">
&lt;strong&gt;[1.77, 2.20]&lt;/strong&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
SE
</td>
<td style="text-align:left;">
1.09
</td>
<td style="text-align:left;">
[0.97, 1.22]
</td>
</tr>
</tbody>
</table>
<p>It will automatically generate the html code needed to create a table. But if we look closely at the code, it gives us some gobbledigook where we inputted html, so we need a way around that. I’m also going to throw in <code>kable_styling(full_width = F)</code> from the <code>kableExtra</code> package to help out here. It’s not doing much, but it will make the formatted table print in your Viewer.</p>
<pre class="r code-style"><code>kable(tidy1, escape = F) %&gt;%
  kable_styling(full_width = F)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Trait
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OP
</td>
<td style="text-align:left;">
<strong>1.68</strong>
</td>
<td style="text-align:left;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
DEP
</td>
<td style="text-align:left;">
<strong>1.15</strong>
</td>
<td style="text-align:left;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
NegAff
</td>
<td style="text-align:left;">
<strong>1.11</strong>
</td>
<td style="text-align:left;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
PA
</td>
<td style="text-align:left;">
<strong>1.97</strong>
</td>
<td style="text-align:left;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
SE
</td>
<td style="text-align:left;">
1.09
</td>
<td style="text-align:left;">
[0.97, 1.22]
</td>
</tr>
</tbody>
</table>
<p>Much better. But this still doesn’t look like an APA table, so let’s keep going.</p>
<ol style="list-style-type: decimal">
<li>APA tables usually write out long names for our predictors, so let’s change those first. I’m going to create a reference tibble and use <code>mapvalues()</code> from the <code>plyr</code> function for this.</li>
</ol>
<pre class="r code-style"><code>p_names &lt;- tibble(
  old = c(&quot;NegAff&quot;, &quot;PA&quot;, &quot;SE&quot;, &quot;OP&quot;, &quot;DEP&quot;),
  new = c(&quot;Negative Affect&quot;, &quot;Positive Affect&quot;, &quot;Self-Esteem&quot;, &quot;Optimism&quot;, &quot;Depression&quot;)
)

tidy1 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new)) %&gt;%
  arrange(Trait) %&gt;%
  kable(., escape = F) %&gt;%
  kable_styling(full_width = F)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Trait
</th>
<th style="text-align:left;">
OR
</th>
<th style="text-align:left;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Negative Affect
</td>
<td style="text-align:left;">
<strong>1.11</strong>
</td>
<td style="text-align:left;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
Positive Affect
</td>
<td style="text-align:left;">
<strong>1.97</strong>
</td>
<td style="text-align:left;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
Self-Esteem
</td>
<td style="text-align:left;">
1.09
</td>
<td style="text-align:left;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:left;">
Optimism
</td>
<td style="text-align:left;">
<strong>1.68</strong>
</td>
<td style="text-align:left;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:left;">
Depression
</td>
<td style="text-align:left;">
<strong>1.15</strong>
</td>
<td style="text-align:left;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
</tbody>
</table>
<p>The combinatin of factor plus arrange here is super helpful for ordering your table.</p>
<ol start="2" style="list-style-type: decimal">
<li>The alignment of the columns isn’t quite right. Let’s fix that. We’ll change the trait to right justified and b and CI to centered.</li>
</ol>
<pre class="r code-style"><code>tidy1 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new)) %&gt;%
  arrange(Trait) %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, &quot;c&quot;, &quot;c&quot;)) %&gt;%
  kable_styling(full_width = F)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li>But we’re still missing our span header. There’s a great function in the <code>kableExtra</code> package for this <code>add_header_above</code>. This function takes a named vector as argument, where the elements of the vector refer to the number of columns the named element should span.</li>
</ol>
<pre class="r code-style"><code>tidy1 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new)) %&gt;%
  arrange(Trait) %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, &quot;c&quot;, &quot;c&quot;)) %&gt;%
  kable_styling(full_width = F) %&gt;%
  add_header_above(c(&quot; &quot; = 1, &quot;Birth of a Child&quot; = 2))</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
</tbody>
</table>
<p>Note that what the <code>" " = 1</code> does is skip the Trait column. This is very useful because it let’s us not have a span header over every column.</p>
<ol start="4" style="list-style-type: decimal">
<li>APA style requires we note how we denote significance and have a title, so let’s add a title and a note.</li>
</ol>
<pre class="r code-style"><code>tidy1 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new)) %&gt;%
  arrange(Trait) %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, &quot;c&quot;, &quot;c&quot;),
        caption = &quot;&lt;strong&gt;Table 1&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Estimated Personality-Outcome Associations&lt;/em&gt;&quot;) %&gt;%
  kable_styling(full_width = F) %&gt;%
  add_header_above(c(&quot; &quot; = 1, &quot;Birth of a Child&quot; = 2)) %&gt;%
  add_footnote(label = &quot;Bold values indicate terms whose confidence intervals did not overlap with 0&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-21">Table 1: </span><strong>Table 1</strong><br><em>Estimated Personality-Outcome Associations</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Bold values indicate terms whose confidence intervals did not overlap with 0
</td>
</tr>
</tfoot>
</table>
<p>We did it!</p>
</div>
</div>
<div id="a-quick-note-html-v.-latex" class="section level1">
<h1>A Quick Note: HTML v. LaTeX</h1>
<p>When creating tables, I prefer using HTML when I need the resulting tables to be in HTML and LaTeX when I can place the tables in a PDF. The syntax using <code>kable</code> and <code>kableExtra</code> is the same with the following exceptions:</p>
<ol style="list-style-type: decimal">
<li>The <code>format</code> argument in <code>kable()</code> would need to be set as <code>format = "latex"</code>.<br />
</li>
<li>The chunk option for a table to render would need to be set as <code>{r, results = 'asis'}</code>.<br />
</li>
<li>Bolding would need to be done as <code>\\textbf{}</code>, rather than the <code>html</code> <code>&lt;strong&gt;&lt;/strong&gt;</code> tag.<br />
</li>
<li>When using <code>collapse_rows()</code>, which we’ll get to later, you’d want to set the <code>latex_hline</code> argument to <code>latex_hline = "none"</code>.</li>
</ol>
</div>
<div id="intermediate-lessons-multiple-dvsoutcomes-multiple-model-terms" class="section level1">
<h1>Intermediate Lessons: Multiple DVs/Outcomes, Multiple Model Terms</h1>
<p>Often, our models are not quite so simple. So what happens when we mix multiple outcomes/DVs and multiple predictors / IVs? Thankfully, not much is different!</p>
<p>Below, we’ll go through the steps. I’ll skip over explaining ones that were explained in detail in the first example and focus on the new pieces.</p>
<div id="set-up-data" class="section level2">
<h2>Set Up Data</h2>
<pre class="r code-style"><code>gsoep_nested2 &lt;- gsoep %&gt;%
  group_by(Trait, Outcome) %&gt;%
  nest() %&gt;%
  ungroup()
gsoep_nested2</code></pre>
<pre><code>## # A tibble: 20 x 3
##    Outcome   Trait  data                  
##    &lt;chr&gt;     &lt;chr&gt;  &lt;list&gt;                
##  1 chldbrth  OP     &lt;tibble [9,192 × 19]&gt; 
##  2 divorced  OP     &lt;tibble [10,140 × 19]&gt;
##  3 married   OP     &lt;tibble [9,398 × 19]&gt; 
##  4 mvInPrtnr OP     &lt;tibble [9,262 × 19]&gt; 
##  5 chldbrth  DEP    &lt;tibble [28,634 × 19]&gt;
##  6 chldbrth  NegAff &lt;tibble [16,992 × 19]&gt;
##  7 chldbrth  PA     &lt;tibble [16,969 × 19]&gt;
##  8 chldbrth  SE     &lt;tibble [7,934 × 19]&gt; 
##  9 divorced  DEP    &lt;tibble [31,416 × 19]&gt;
## 10 divorced  NegAff &lt;tibble [19,053 × 19]&gt;
## 11 divorced  PA     &lt;tibble [19,027 × 19]&gt;
## 12 divorced  SE     &lt;tibble [8,930 × 19]&gt; 
## 13 married   DEP    &lt;tibble [29,203 × 19]&gt;
## 14 married   NegAff &lt;tibble [17,316 × 19]&gt;
## 15 married   PA     &lt;tibble [17,295 × 19]&gt;
## 16 married   SE     &lt;tibble [8,061 × 19]&gt; 
## 17 mvInPrtnr DEP    &lt;tibble [28,891 × 19]&gt;
## 18 mvInPrtnr NegAff &lt;tibble [17,016 × 19]&gt;
## 19 mvInPrtnr PA     &lt;tibble [16,990 × 19]&gt;
## 20 mvInPrtnr SE     &lt;tibble [7,932 × 19]&gt;</code></pre>
</div>
<div id="run-the-models" class="section level2">
<h2>Run the models</h2>
<pre class="r code-style"><code>mod1_fun &lt;- function(d){
  d$o_value &lt;- factor(d$o_value)
  glm(o_value ~ p_value, data = d, family = binomial(link = &quot;logit&quot;))
}

gsoep_nested2 &lt;- gsoep_nested2 %&gt;%
  mutate(m = map(data, mod1_fun),
         tidy = map(m, ~tidy(., conf.int = T)))
gsoep_nested2</code></pre>
<pre><code>## # A tibble: 20 x 5
##    Outcome   Trait  data                   m      tidy            
##    &lt;chr&gt;     &lt;chr&gt;  &lt;list&gt;                 &lt;list&gt; &lt;list&gt;          
##  1 chldbrth  OP     &lt;tibble [9,192 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  2 divorced  OP     &lt;tibble [10,140 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  3 married   OP     &lt;tibble [9,398 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  4 mvInPrtnr OP     &lt;tibble [9,262 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  5 chldbrth  DEP    &lt;tibble [28,634 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  6 chldbrth  NegAff &lt;tibble [16,992 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  7 chldbrth  PA     &lt;tibble [16,969 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  8 chldbrth  SE     &lt;tibble [7,934 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  9 divorced  DEP    &lt;tibble [31,416 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 10 divorced  NegAff &lt;tibble [19,053 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 11 divorced  PA     &lt;tibble [19,027 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 12 divorced  SE     &lt;tibble [8,930 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 13 married   DEP    &lt;tibble [29,203 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 14 married   NegAff &lt;tibble [17,316 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 15 married   PA     &lt;tibble [17,295 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 16 married   SE     &lt;tibble [8,061 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 17 mvInPrtnr DEP    &lt;tibble [28,891 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 18 mvInPrtnr NegAff &lt;tibble [17,016 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 19 mvInPrtnr PA     &lt;tibble [16,990 × 19]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
## 20 mvInPrtnr SE     &lt;tibble [7,932 × 19]&gt;  &lt;glm&gt;  &lt;tibble [2 × 7]&gt;</code></pre>
</div>
<div id="create-the-table" class="section level2">
<h2>Create the Table</h2>
<pre class="r code-style"><code>tidy2 &lt;- gsoep_nested2 %&gt;%
  select(Outcome, Trait, tidy) %&gt;%
  unnest(tidy)
tidy2</code></pre>
<pre><code>## # A tibble: 40 x 9
##    Outcome Trait term  estimate std.error statistic   p.value conf.low conf.high
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1 chldbr… OP    (Int…  -4.30      0.186     -23.1  1.84e-118  -4.67      -3.94 
##  2 chldbr… OP    p_va…   0.518     0.0582      8.90 5.53e- 19   0.405      0.633
##  3 divorc… OP    (Int…  -4.11      0.255     -16.1  2.71e- 58  -4.62      -3.62 
##  4 divorc… OP    p_va…   0.0981    0.0850      1.15 2.48e-  1  -0.0672     0.266
##  5 married OP    (Int…  -3.42      0.160     -21.4  9.09e-102  -3.74      -3.12 
##  6 married OP    p_va…   0.275     0.0520      5.28 1.28e-  7   0.173      0.377
##  7 mvInPr… OP    (Int…  -4.30      0.198     -21.7  1.12e-104  -4.70      -3.92 
##  8 mvInPr… OP    p_va…   0.459     0.0625      7.34 2.17e- 13   0.337      0.582
##  9 chldbr… DEP   (Int…  -3.48      0.146     -23.8  3.86e-125  -3.76      -3.19 
## 10 chldbr… DEP   p_va…   0.143     0.0364      3.92 9.00e-  5   0.0716     0.214
## # … with 30 more rows</code></pre>
<p>The basic steps from here are similar: filter target terms, index significance, exponentiate, format values, create CI’s, bold significance, select needed columns.</p>
<pre class="r code-style"><code>tidy2 &lt;- tidy2 %&gt;%
  filter(term == &quot;p_value&quot;) %&gt;%
  mutate(sig = ifelse(sign(conf.low) == sign(conf.high), &quot;sig&quot;, &quot;ns&quot;)) %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), exp) %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), ~sprintf(&quot;%.2f&quot;, .)) %&gt;%
  mutate(CI = sprintf(&quot;[%s, %s]&quot;, conf.low, conf.high)) %&gt;%
  mutate_at(vars(estimate, CI), ~ifelse(sig == &quot;sig&quot;, sprintf(&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;, .), .)) %&gt;%
  select(Outcome, Trait, OR = estimate, CI)
tidy2</code></pre>
<pre><code>## # A tibble: 20 x 4
##    Outcome   Trait  OR                    CI                           
##    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;                 &lt;chr&gt;                        
##  1 chldbrth  OP     &lt;strong&gt;1.68&lt;/strong&gt; &lt;strong&gt;[1.50, 1.88]&lt;/strong&gt;
##  2 divorced  OP     1.10                  [0.93, 1.30]                 
##  3 married   OP     &lt;strong&gt;1.32&lt;/strong&gt; &lt;strong&gt;[1.19, 1.46]&lt;/strong&gt;
##  4 mvInPrtnr OP     &lt;strong&gt;1.58&lt;/strong&gt; &lt;strong&gt;[1.40, 1.79]&lt;/strong&gt;
##  5 chldbrth  DEP    &lt;strong&gt;1.15&lt;/strong&gt; &lt;strong&gt;[1.07, 1.24]&lt;/strong&gt;
##  6 chldbrth  NegAff &lt;strong&gt;1.11&lt;/strong&gt; &lt;strong&gt;[1.01, 1.22]&lt;/strong&gt;
##  7 chldbrth  PA     &lt;strong&gt;1.97&lt;/strong&gt; &lt;strong&gt;[1.77, 2.20]&lt;/strong&gt;
##  8 chldbrth  SE     1.09                  [0.97, 1.22]                 
##  9 divorced  DEP    &lt;strong&gt;0.74&lt;/strong&gt; &lt;strong&gt;[0.67, 0.82]&lt;/strong&gt;
## 10 divorced  NegAff &lt;strong&gt;1.58&lt;/strong&gt; &lt;strong&gt;[1.38, 1.80]&lt;/strong&gt;
## 11 divorced  PA     &lt;strong&gt;0.85&lt;/strong&gt; &lt;strong&gt;[0.74, 0.97]&lt;/strong&gt;
## 12 divorced  SE     0.95                  [0.81, 1.12]                 
## 13 married   DEP    0.99                  [0.93, 1.06]                 
## 14 married   NegAff &lt;strong&gt;1.29&lt;/strong&gt; &lt;strong&gt;[1.19, 1.40]&lt;/strong&gt;
## 15 married   PA     &lt;strong&gt;1.63&lt;/strong&gt; &lt;strong&gt;[1.49, 1.78]&lt;/strong&gt;
## 16 married   SE     &lt;strong&gt;0.86&lt;/strong&gt; &lt;strong&gt;[0.79, 0.94]&lt;/strong&gt;
## 17 mvInPrtnr DEP    &lt;strong&gt;0.91&lt;/strong&gt; &lt;strong&gt;[0.85, 0.98]&lt;/strong&gt;
## 18 mvInPrtnr NegAff &lt;strong&gt;1.33&lt;/strong&gt; &lt;strong&gt;[1.21, 1.47]&lt;/strong&gt;
## 19 mvInPrtnr PA     &lt;strong&gt;1.36&lt;/strong&gt; &lt;strong&gt;[1.21, 1.52]&lt;/strong&gt;
## 20 mvInPrtnr SE     1.00                  [0.88, 1.13]</code></pre>
<p>Great, we’re all set right? Not quite. If we want to do a span header, we need our data in shape for that. But right now, our outcomes are rows, not columns. To get them as columns, we will need to: (1) <code>pivot_longer()</code> the OR’s and CI’s, (2) <code>unite()</code> the outcomes and type of estimate, (3) <code>pivot_wider()</code> these united terms, (4) reorder these columns as we want.</p>
<p>Let’s do each in turn:<br />
(1) Long format</p>
<pre class="r code-style"><code>tidy2 &lt;- tidy2 %&gt;%
  pivot_longer(cols = c(OR, CI), names_to = &quot;est&quot;, values_to = &quot;value&quot;)
tidy2</code></pre>
<pre><code>## # A tibble: 40 x 4
##    Outcome   Trait est   value                        
##    &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                        
##  1 chldbrth  OP    OR    &lt;strong&gt;1.68&lt;/strong&gt;        
##  2 chldbrth  OP    CI    &lt;strong&gt;[1.50, 1.88]&lt;/strong&gt;
##  3 divorced  OP    OR    1.10                         
##  4 divorced  OP    CI    [0.93, 1.30]                 
##  5 married   OP    OR    &lt;strong&gt;1.32&lt;/strong&gt;        
##  6 married   OP    CI    &lt;strong&gt;[1.19, 1.46]&lt;/strong&gt;
##  7 mvInPrtnr OP    OR    &lt;strong&gt;1.58&lt;/strong&gt;        
##  8 mvInPrtnr OP    CI    &lt;strong&gt;[1.40, 1.79]&lt;/strong&gt;
##  9 chldbrth  DEP   OR    &lt;strong&gt;1.15&lt;/strong&gt;        
## 10 chldbrth  DEP   CI    &lt;strong&gt;[1.07, 1.24]&lt;/strong&gt;
## # … with 30 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Unite!</li>
</ol>
<pre class="r code-style"><code>tidy2 &lt;- tidy2 %&gt;%
  unite(tmp, Outcome, est, sep = &quot;_&quot;)
tidy2</code></pre>
<pre><code>## # A tibble: 40 x 3
##    tmp          Trait value                        
##    &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;                        
##  1 chldbrth_OR  OP    &lt;strong&gt;1.68&lt;/strong&gt;        
##  2 chldbrth_CI  OP    &lt;strong&gt;[1.50, 1.88]&lt;/strong&gt;
##  3 divorced_OR  OP    1.10                         
##  4 divorced_CI  OP    [0.93, 1.30]                 
##  5 married_OR   OP    &lt;strong&gt;1.32&lt;/strong&gt;        
##  6 married_CI   OP    &lt;strong&gt;[1.19, 1.46]&lt;/strong&gt;
##  7 mvInPrtnr_OR OP    &lt;strong&gt;1.58&lt;/strong&gt;        
##  8 mvInPrtnr_CI OP    &lt;strong&gt;[1.40, 1.79]&lt;/strong&gt;
##  9 chldbrth_OR  DEP   &lt;strong&gt;1.15&lt;/strong&gt;        
## 10 chldbrth_CI  DEP   &lt;strong&gt;[1.07, 1.24]&lt;/strong&gt;
## # … with 30 more rows</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Pivot wider</li>
</ol>
<pre class="r code-style"><code>tidy2 &lt;- tidy2 %&gt;%
  pivot_wider(names_from = &quot;tmp&quot;, values_from = &quot;value&quot;)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create the order of columns</li>
</ol>
<pre class="r code-style"><code>O_names &lt;- tibble(
  old = c(&quot;mvInPrtnr&quot;, &quot;married&quot;, &quot;divorced&quot;, &quot;chldbrth&quot;),
  new = c(&quot;Move in with Partner&quot;, &quot;Married&quot;, &quot;Divorced&quot;, &quot;Birth of a Child&quot;)
)

levs &lt;- paste(rep(O_names$old, each = 2), rep(c(&quot;OR&quot;,&quot;CI&quot;), times = 4), sep = &quot;_&quot;)
tidy2 &lt;- tidy2 %&gt;%
  select(Trait, all_of(levs))</code></pre>
<p>Now we’re ready to <code>kable()</code>! This will proceed almost exactly as before. The only difference from the previous example is that we have multiple different columns we want to span. Thankfully, we know what these are because we carefully ordered them when we factored them.</p>
<p>For our named vector, we’ll take advantage of our <code>O_names</code> object to create the vector in advance:</p>
<pre class="r code-style"><code>heads &lt;- c(1, rep(2, 4))
heads</code></pre>
<pre><code>## [1] 1 2 2 2 2</code></pre>
<pre class="r code-style"><code>names(heads) &lt;- c(&quot; &quot;, O_names$new)
heads</code></pre>
<pre><code>##                      Move in with Partner              Married 
##                    1                    2                    2 
##             Divorced     Birth of a Child 
##                    2                    2</code></pre>
<pre class="r code-style"><code>tidy2 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new)) %&gt;%
  arrange(Trait) %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, rep(&quot;c&quot;, 8)),
        caption = &quot;&lt;strong&gt;Table 2&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Estimated Personality-Outcome Associations&lt;/em&gt;&quot;) %&gt;%
  kable_styling(full_width = F) %&gt;%
  add_header_above(heads) %&gt;%
  add_footnote(label = &quot;Bold values indicate terms whose confidence intervals did not overlap with 0&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-31">Table 2: </span><strong>Table 2</strong><br><em>Estimated Personality-Outcome Associations</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Move in with Partner
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Married
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Divorced
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:center;">
mvInPrtnr_OR
</th>
<th style="text-align:center;">
mvInPrtnr_CI
</th>
<th style="text-align:center;">
married_OR
</th>
<th style="text-align:center;">
married_CI
</th>
<th style="text-align:center;">
divorced_OR
</th>
<th style="text-align:center;">
divorced_CI
</th>
<th style="text-align:center;">
chldbrth_OR
</th>
<th style="text-align:center;">
chldbrth_CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.47]</strong>
</td>
<td style="text-align:center;">
<strong>1.29</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.40]</strong>
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.38, 1.80]</strong>
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:center;">
<strong>1.36</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.52]</strong>
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.49, 1.78]</strong>
</td>
<td style="text-align:center;">
<strong>0.85</strong>
</td>
<td style="text-align:center;">
<strong>[0.74, 0.97]</strong>
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.88, 1.13]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.94]</strong>
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.81, 1.12]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.79]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.46]</strong>
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
[0.93, 1.30]
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:center;">
<strong>0.91</strong>
</td>
<td style="text-align:center;">
<strong>[0.85, 0.98]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.93, 1.06]
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Bold values indicate terms whose confidence intervals did not overlap with 0
</td>
</tr>
</tfoot>
</table>
<p>Ew, but those column names are terrible. Let’s fix them using the <code>col.names</code> argument in <code>kable()</code>:</p>
<pre class="r code-style"><code>tidy2 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new)) %&gt;%
  arrange(Trait) %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, rep(&quot;c&quot;, 8)),
        col.names = c(&quot;Trait&quot;, rep(c(&quot;OR&quot;, &quot;CI&quot;), times = 4)),
        caption = &quot;&lt;strong&gt;Table 2&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Estimated Personality-Outcome Associations&lt;/em&gt;&quot;) %&gt;%
  kable_styling(full_width = F) %&gt;%
  add_header_above(heads) %&gt;%
  add_footnote(label = &quot;Bold values indicate terms whose confidence intervals did not overlap with 0&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-32">Table 3: </span><strong>Table 2</strong><br><em>Estimated Personality-Outcome Associations</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Move in with Partner
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Married
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Divorced
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.47]</strong>
</td>
<td style="text-align:center;">
<strong>1.29</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.40]</strong>
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.38, 1.80]</strong>
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:center;">
<strong>1.36</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.52]</strong>
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.49, 1.78]</strong>
</td>
<td style="text-align:center;">
<strong>0.85</strong>
</td>
<td style="text-align:center;">
<strong>[0.74, 0.97]</strong>
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.88, 1.13]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.94]</strong>
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.81, 1.12]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.79]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.46]</strong>
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
[0.93, 1.30]
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:center;">
<strong>0.91</strong>
</td>
<td style="text-align:center;">
<strong>[0.85, 0.98]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.93, 1.06]
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Bold values indicate terms whose confidence intervals did not overlap with 0
</td>
</tr>
</tfoot>
</table>
</div>
</div>
<div id="advanced-lessons-multiple-dvsoutcomes-multiple-model-terms-additional-formatting" class="section level1">
<h1>Advanced Lessons: Multiple DVs/Outcomes, Multiple Model Terms, Additional Formatting</h1>
<p>Often, we want to do things like model comparison tests in which we add additional covariates and test if they significantly improve the model or see if they change the direction and magnitude of key terms. Generally, the resulting terms would then be placed in a table.</p>
<p>Below, I’ll cover two cases – covariates and moderators. For the case of moderators, I’ll follow up with simple effects (although these may be added at a later date).</p>
<p>Specifically, we’ll test this for age, gender, parental education, and self-rated health.</p>
<p>To be able to do this, we’ll need to set our data up just a little bit differently. First, this is because we need to center values for testing moderators for variables that aren’t factors or don’t have natural 0 points. Second, the covariates / moderators are currently in wide format, so we’ll need to make them long for our purposes.</p>
<p>Let’s do that first.</p>
<pre class="r code-style"><code>gsoep_long &lt;- gsoep %&gt;%
  select(SID, Outcome, o_value, Trait, p_value, age, gender, parEdu, SRhealth) %&gt;%
  mutate_at(vars(age, SRhealth), ~as.numeric(scale(., center = T, scale = F))) %&gt;%
  pivot_longer(
    cols = c(age, gender, parEdu, SRhealth), 
    values_to = &quot;c_value&quot;, names_to = &quot;Covariate&quot;
    )</code></pre>
<p>We’ll need to worry about changing gender and parental education into factor variables later. I’m going to show you my favorite trick.</p>
<div id="covariates" class="section level2">
<h2>Covariates</h2>
<div id="set-up-data-1" class="section level3">
<h3>Set up Data</h3>
<p>This time, we need to add a new grouping variable – namely, the target covariates.</p>
<p>Only trick is we also need the combination with no covariate. There’s lots of ways to add this on. I’ll show you one way.</p>
<pre class="r code-style"><code>gsoep_nested3 &lt;- gsoep_long %&gt;%
  full_join(gsoep %&gt;% select(SID, Outcome, o_value, Trait, p_value) %&gt;%
              mutate(Covariate = &quot;none&quot;)) %&gt;% 
  group_by(Trait, Outcome, Covariate) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;%
  arrange(Outcome, Trait, Covariate)
gsoep_nested3</code></pre>
<pre><code>## # A tibble: 100 x 4
##    Outcome  Trait  Covariate data                 
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;               
##  1 chldbrth DEP    age       &lt;tibble [28,634 × 4]&gt;
##  2 chldbrth DEP    gender    &lt;tibble [28,634 × 4]&gt;
##  3 chldbrth DEP    none      &lt;tibble [28,634 × 4]&gt;
##  4 chldbrth DEP    parEdu    &lt;tibble [28,634 × 4]&gt;
##  5 chldbrth DEP    SRhealth  &lt;tibble [28,634 × 4]&gt;
##  6 chldbrth NegAff age       &lt;tibble [16,992 × 4]&gt;
##  7 chldbrth NegAff gender    &lt;tibble [16,992 × 4]&gt;
##  8 chldbrth NegAff none      &lt;tibble [16,992 × 4]&gt;
##  9 chldbrth NegAff parEdu    &lt;tibble [16,992 × 4]&gt;
## 10 chldbrth NegAff SRhealth  &lt;tibble [16,992 × 4]&gt;
## # … with 90 more rows</code></pre>
</div>
<div id="run-the-models-1" class="section level3">
<h3>Run the models</h3>
<pre class="r code-style"><code>factor_fun &lt;- function(x){if(is.numeric(x)){diff(range(x, na.rm = T)) %in% 1:2 &amp; length(unique(x)) &lt;= 4} else{F}}

mod3_fun &lt;- function(d, cov){
  d$o_value &lt;- factor(d$o_value)
  d &lt;- d %&gt;% mutate_if(factor_fun, factor)
  if(cov == &quot;none&quot;){f &lt;- formula(o_value ~ p_value)} else{f &lt;- formula(o_value ~ p_value + c_value)}
  glm(f, data = d, family = binomial(link = &quot;logit&quot;))
}

gsoep_nested3 &lt;- gsoep_nested3 %&gt;%
  mutate(m = map2(data, Covariate, mod3_fun),
         tidy = map(m, ~tidy(., conf.int = T)))
gsoep_nested3</code></pre>
<pre><code>## # A tibble: 100 x 6
##    Outcome  Trait  Covariate data                  m      tidy            
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;                &lt;list&gt; &lt;list&gt;          
##  1 chldbrth DEP    age       &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [3 × 7]&gt;
##  2 chldbrth DEP    gender    &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [3 × 7]&gt;
##  3 chldbrth DEP    none      &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  4 chldbrth DEP    parEdu    &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  5 chldbrth DEP    SRhealth  &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [3 × 7]&gt;
##  6 chldbrth NegAff age       &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [3 × 7]&gt;
##  7 chldbrth NegAff gender    &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [3 × 7]&gt;
##  8 chldbrth NegAff none      &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [2 × 7]&gt;
##  9 chldbrth NegAff parEdu    &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
## 10 chldbrth NegAff SRhealth  &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [3 × 7]&gt;
## # … with 90 more rows</code></pre>
<p>Looking specifically at the <code>tidy</code> column, notice that there are different numbers of rows. This is good! We should see 3 rows for age, gender, and SRhealth because we have one new term – a continuous covariate of two level binary covariate. We should see 4 rows for parEdu because we have two new terms – for a three level categorical covariate. Finally, when there is no covariate, we should just have 2 rows like in the previous example.</p>
</div>
<div id="create-the-table-1" class="section level3">
<h3>Create the Table</h3>
<pre class="r code-style"><code>tidy3 &lt;- gsoep_nested3 %&gt;%
  select(Outcome, Trait, Covariate, tidy) %&gt;%
  unnest(tidy)
tidy3</code></pre>
<pre><code>## # A tibble: 300 x 10
##    Outcome Trait Covariate term  estimate std.error statistic   p.value conf.low
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 chldbr… DEP   age       (Int…  -4.06     0.161      -25.1  1.95e-139 -4.37   
##  2 chldbr… DEP   age       p_va…   0.146    0.0397       3.69 2.26e-  4  0.0690 
##  3 chldbr… DEP   age       c_va…  -0.0663   0.00178    -37.3  2.96e-304 -0.0698 
##  4 chldbr… DEP   gender    (Int…  -3.57     0.153      -23.3  5.75e-120 -3.87   
##  5 chldbr… DEP   gender    p_va…   0.151    0.0367       4.11 3.91e-  5  0.0794 
##  6 chldbr… DEP   gender    c_va…   0.113    0.0541       2.09 3.66e-  2  0.00719
##  7 chldbr… DEP   none      (Int…  -3.48     0.146      -23.8  3.86e-125 -3.76   
##  8 chldbr… DEP   none      p_va…   0.143    0.0364       3.92 9.00e-  5  0.0716 
##  9 chldbr… DEP   parEdu    (Int…  -3.49     0.150      -23.2  2.26e-119 -3.78   
## 10 chldbr… DEP   parEdu    p_va…   0.117    0.0374       3.14 1.69e-  3  0.0446 
## # … with 290 more rows, and 1 more variable: conf.high &lt;dbl&gt;</code></pre>
<p>The basic steps from here are similar: filter target terms, index significance, exponentiate, format values, create CI’s, bold significance, select needed columns.</p>
<pre class="r code-style"><code>tidy3 &lt;- tidy3 %&gt;%
  filter(term == &quot;p_value&quot;) %&gt;%
  mutate(sig = ifelse(sign(conf.low) == sign(conf.high), &quot;sig&quot;, &quot;ns&quot;)) %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), exp) %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), ~sprintf(&quot;%.2f&quot;, .)) %&gt;%
  mutate(CI = sprintf(&quot;[%s, %s]&quot;, conf.low, conf.high)) %&gt;%
  mutate_at(vars(estimate, CI), ~ifelse(sig == &quot;sig&quot;, sprintf(&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;, .), .)) %&gt;%
  select(Outcome, Trait, Covariate, OR = estimate, CI)</code></pre>
<p>Now we’re ready for the <code>pivot_longer()</code>, <code>unite()</code>, <code>pivot_wider()</code>, order columns (using <code>select()</code>) combo from before. The only difference is that I’m going to use <code>pivot_wider()</code> to do the uniting for me this time!</p>
<pre class="r code-style"><code>O_names &lt;- tibble(
  old = c(&quot;mvInPrtnr&quot;, &quot;married&quot;, &quot;divorced&quot;, &quot;chldbrth&quot;),
  new = c(&quot;Move in with Partner&quot;, &quot;Married&quot;, &quot;Divorced&quot;, &quot;Birth of a Child&quot;)
)
levs &lt;- paste(rep(O_names$old, each = 2), rep(c(&quot;OR&quot;,&quot;CI&quot;), times = 4), sep = &quot;_&quot;)

tidy3 &lt;- tidy3 %&gt;%
  pivot_longer(cols = c(OR, CI), names_to = &quot;est&quot;, values_to = &quot;value&quot;) %&gt;%
  pivot_wider(names_from = c(&quot;Outcome&quot;, &quot;est&quot;), values_from = &quot;value&quot;, names_sep = &quot;_&quot;) %&gt;%
  select(Trait, Covariate, all_of(levs))
tidy3</code></pre>
<pre><code>## # A tibble: 25 x 10
##    Trait  Covariate mvInPrtnr_OR  mvInPrtnr_CI married_OR married_CI divorced_OR
##    &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      
##  1 DEP    age       &lt;strong&gt;0.88… &lt;strong&gt;[0.… 0.99       [0.92, 1.… &lt;strong&gt;0.…
##  2 DEP    gender    &lt;strong&gt;0.91… &lt;strong&gt;[0.… 0.99       [0.93, 1.… &lt;strong&gt;0.…
##  3 DEP    none      &lt;strong&gt;0.91… &lt;strong&gt;[0.… 0.99       [0.93, 1.… &lt;strong&gt;0.…
##  4 DEP    parEdu    &lt;strong&gt;0.89… &lt;strong&gt;[0.… 0.97       [0.91, 1.… &lt;strong&gt;0.…
##  5 DEP    SRhealth  &lt;strong&gt;0.63… &lt;strong&gt;[0.… &lt;strong&gt;0… &lt;strong&gt;[… &lt;strong&gt;0.…
##  6 NegAff age       &lt;strong&gt;1.20… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  7 NegAff gender    &lt;strong&gt;1.34… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  8 NegAff none      &lt;strong&gt;1.33… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  9 NegAff parEdu    &lt;strong&gt;1.35… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
## 10 NegAff SRhealth  &lt;strong&gt;1.58… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
## # … with 15 more rows, and 3 more variables: divorced_CI &lt;chr&gt;,
## #   chldbrth_OR &lt;chr&gt;, chldbrth_CI &lt;chr&gt;</code></pre>
<p>All right, time to use <code>kable()</code>! This will proceed almost exactly as before. The only difference from the previous example is that we have multiple different models with different combinations of p_value terms depending on what we controlled for. So we’ll introduce a new function <code>collapse_rows()</code> from <code>kableExtra</code>.</p>
<p>Given that we have multiple covariates, we’ll also want to order them. So we’ll make the Covariate column a factor as well. But we’ll do so after we’ve given our covariates nicer names. While we’re at it, we’ll go ahead and do the same things for our Trait column.</p>
<pre class="r code-style"><code>c_names &lt;- tibble(
  old = c(&quot;none&quot;, &quot;age&quot;, &quot;SRhealth&quot;, &quot;gender&quot;, &quot;parEdu&quot;),
  new = c(&quot;None&quot;, &quot;Age&quot;, &quot;Self-Rated Health&quot;, &quot;Gender&quot;, &quot;Parental Education&quot;)
)

tidy3 &lt;- tidy3 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new),
         Covariate = mapvalues(Covariate, from = c_names$old, to = c_names$new),
         Covariate = factor(Covariate, levels = c_names$new)) %&gt;%
  arrange(Trait, Covariate)
tidy3</code></pre>
<pre><code>## # A tibble: 25 x 10
##    Trait  Covariate  mvInPrtnr_OR mvInPrtnr_CI married_OR married_CI divorced_OR
##    &lt;fct&gt;  &lt;fct&gt;      &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;      
##  1 Negat… None       &lt;strong&gt;1.3… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  2 Negat… Age        &lt;strong&gt;1.2… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  3 Negat… Self-Rate… &lt;strong&gt;1.5… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  4 Negat… Gender     &lt;strong&gt;1.3… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  5 Negat… Parental … &lt;strong&gt;1.3… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;1.…
##  6 Posit… None       &lt;strong&gt;1.3… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;0.…
##  7 Posit… Age        1.11         [0.99, 1.24] &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;0.…
##  8 Posit… Self-Rate… &lt;strong&gt;1.1… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;0.…
##  9 Posit… Gender     &lt;strong&gt;1.3… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;0.…
## 10 Posit… Parental … &lt;strong&gt;1.3… &lt;strong&gt;[1.… &lt;strong&gt;1… &lt;strong&gt;[… &lt;strong&gt;0.…
## # … with 15 more rows, and 3 more variables: divorced_CI &lt;chr&gt;,
## #   chldbrth_OR &lt;chr&gt;, chldbrth_CI &lt;chr&gt;</code></pre>
<p>And again, for our spanned columns, we’ll take advantage of our <code>O_names</code> object to create the vector in advance:</p>
<pre class="r code-style"><code>heads &lt;- rep(2, 5)
heads</code></pre>
<pre><code>## [1] 2 2 2 2 2</code></pre>
<pre class="r code-style"><code>names(heads) &lt;- c(&quot; &quot;, O_names$new)
heads</code></pre>
<pre><code>##                      Move in with Partner              Married 
##                    2                    2                    2 
##             Divorced     Birth of a Child 
##                    2                    2</code></pre>
<p>Now, this will proceed as before, with just a few small tweaks to the <code>align</code> and <code>col.names</code> arguments to account for the additional Covariate column.</p>
<pre class="r code-style"><code>tidy3 %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, &quot;r&quot;, rep(&quot;c&quot;, 8)),
        col.names = c(&quot;Trait&quot;, &quot;Covariate&quot;, rep(c(&quot;OR&quot;, &quot;CI&quot;), times = 4)),
        caption = &quot;&lt;strong&gt;Table 3&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Estimated Personality-Outcome Associations&lt;/em&gt;&quot;) %&gt;%
  kable_styling(full_width = F) %&gt;%
  add_header_above(heads) %&gt;%
  add_footnote(label = &quot;Bold values indicate terms whose confidence intervals did not overlap with 0&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-41">Table 4: </span><strong>Table 3</strong><br><em>Estimated Personality-Outcome Associations</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Move in with Partner
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Married
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Divorced
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:right;">
Covariate
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.47]</strong>
</td>
<td style="text-align:center;">
<strong>1.29</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.40]</strong>
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.38, 1.80]</strong>
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>1.20</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.33]</strong>
</td>
<td style="text-align:center;">
<strong>1.17</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.27]</strong>
</td>
<td style="text-align:center;">
<strong>1.51</strong>
</td>
<td style="text-align:center;">
<strong>[1.32, 1.73]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.90, 1.09]
</td>
</tr>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.42, 1.75]</strong>
</td>
<td style="text-align:center;">
<strong>1.53</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.66]</strong>
</td>
<td style="text-align:center;">
<strong>1.70</strong>
</td>
<td style="text-align:center;">
<strong>[1.48, 1.95]</strong>
</td>
<td style="text-align:center;">
<strong>1.39</strong>
</td>
<td style="text-align:center;">
<strong>[1.26, 1.53]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>1.34</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.48]</strong>
</td>
<td style="text-align:center;">
<strong>1.30</strong>
</td>
<td style="text-align:center;">
<strong>[1.20, 1.41]</strong>
</td>
<td style="text-align:center;">
<strong>1.59</strong>
</td>
<td style="text-align:center;">
<strong>[1.39, 1.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Negative Affect
</td>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>1.35</strong>
</td>
<td style="text-align:center;">
<strong>[1.22, 1.49]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.43]</strong>
</td>
<td style="text-align:center;">
<strong>1.61</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.84]</strong>
</td>
<td style="text-align:center;">
<strong>1.12</strong>
</td>
<td style="text-align:center;">
<strong>[1.02, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>1.36</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.52]</strong>
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.49, 1.78]</strong>
</td>
<td style="text-align:center;">
<strong>0.85</strong>
</td>
<td style="text-align:center;">
<strong>[0.74, 0.97]</strong>
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.11
</td>
<td style="text-align:center;">
[0.99, 1.24]
</td>
<td style="text-align:center;">
<strong>1.35</strong>
</td>
<td style="text-align:center;">
<strong>[1.23, 1.48]</strong>
</td>
<td style="text-align:center;">
<strong>0.77</strong>
</td>
<td style="text-align:center;">
<strong>[0.68, 0.89]</strong>
</td>
<td style="text-align:center;">
<strong>1.61</strong>
</td>
<td style="text-align:center;">
<strong>[1.44, 1.80]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.16</strong>
</td>
<td style="text-align:center;">
<strong>[1.03, 1.31]</strong>
</td>
<td style="text-align:center;">
<strong>1.42</strong>
</td>
<td style="text-align:center;">
<strong>[1.29, 1.56]</strong>
</td>
<td style="text-align:center;">
<strong>0.79</strong>
</td>
<td style="text-align:center;">
<strong>[0.68, 0.91]</strong>
</td>
<td style="text-align:center;">
<strong>1.61</strong>
</td>
<td style="text-align:center;">
<strong>[1.44, 1.81]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>1.35</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.52]</strong>
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.49, 1.78]</strong>
</td>
<td style="text-align:center;">
<strong>0.85</strong>
</td>
<td style="text-align:center;">
<strong>[0.74, 0.97]</strong>
</td>
<td style="text-align:center;">
<strong>1.96</strong>
</td>
<td style="text-align:center;">
<strong>[1.76, 2.19]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Positive Affect
</td>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>1.31</strong>
</td>
<td style="text-align:center;">
<strong>[1.17, 1.47]</strong>
</td>
<td style="text-align:center;">
<strong>1.55</strong>
</td>
<td style="text-align:center;">
<strong>[1.42, 1.70]</strong>
</td>
<td style="text-align:center;">
<strong>0.87</strong>
</td>
<td style="text-align:center;">
<strong>[0.75, 1.00]</strong>
</td>
<td style="text-align:center;">
<strong>1.87</strong>
</td>
<td style="text-align:center;">
<strong>[1.68, 2.09]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.88, 1.13]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.94]</strong>
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.81, 1.12]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.07
</td>
<td style="text-align:center;">
[0.94, 1.22]
</td>
<td style="text-align:center;">
<strong>0.90</strong>
</td>
<td style="text-align:center;">
<strong>[0.83, 0.99]</strong>
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.82, 1.15]
</td>
<td style="text-align:center;">
<strong>1.18</strong>
</td>
<td style="text-align:center;">
<strong>[1.05, 1.33]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
0.94
</td>
<td style="text-align:center;">
[0.83, 1.07]
</td>
<td style="text-align:center;">
<strong>0.79</strong>
</td>
<td style="text-align:center;">
<strong>[0.73, 0.87]</strong>
</td>
<td style="text-align:center;">
0.92
</td>
<td style="text-align:center;">
[0.78, 1.09]
</td>
<td style="text-align:center;">
0.98
</td>
<td style="text-align:center;">
[0.87, 1.10]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.88, 1.13]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.94]</strong>
</td>
<td style="text-align:center;">
0.94
</td>
<td style="text-align:center;">
[0.81, 1.12]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.98, 1.23]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Esteem
</td>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.87, 1.12]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.93]</strong>
</td>
<td style="text-align:center;">
0.96
</td>
<td style="text-align:center;">
[0.82, 1.15]
</td>
<td style="text-align:center;">
1.08
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.79]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.46]</strong>
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
[0.93, 1.30]
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>1.23</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.41]</strong>
</td>
<td style="text-align:center;">
1.08
</td>
<td style="text-align:center;">
[0.97, 1.20]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.85, 1.19]
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.18, 1.50]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.17, 1.51]</strong>
</td>
<td style="text-align:center;">
1.11
</td>
<td style="text-align:center;">
[1.00, 1.24]
</td>
<td style="text-align:center;">
1.04
</td>
<td style="text-align:center;">
[0.87, 1.24]
</td>
<td style="text-align:center;">
<strong>1.31</strong>
</td>
<td style="text-align:center;">
<strong>[1.16, 1.48]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.79]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.46]</strong>
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
[0.93, 1.30]
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.89]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Optimism
</td>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>1.50</strong>
</td>
<td style="text-align:center;">
<strong>[1.32, 1.70]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.47]</strong>
</td>
<td style="text-align:center;">
1.07
</td>
<td style="text-align:center;">
[0.90, 1.27]
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.45, 1.83]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>0.91</strong>
</td>
<td style="text-align:center;">
<strong>[0.85, 0.98]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.93, 1.06]
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>0.88</strong>
</td>
<td style="text-align:center;">
<strong>[0.81, 0.95]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.92, 1.06]
</td>
<td style="text-align:center;">
<strong>0.73</strong>
</td>
<td style="text-align:center;">
<strong>[0.66, 0.80]</strong>
</td>
<td style="text-align:center;">
<strong>1.16</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.25]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>0.63</strong>
</td>
<td style="text-align:center;">
<strong>[0.59, 0.69]</strong>
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.69, 0.80]</strong>
</td>
<td style="text-align:center;">
<strong>0.63</strong>
</td>
<td style="text-align:center;">
<strong>[0.56, 0.70]</strong>
</td>
<td style="text-align:center;">
<strong>0.77</strong>
</td>
<td style="text-align:center;">
<strong>[0.71, 0.83]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>0.91</strong>
</td>
<td style="text-align:center;">
<strong>[0.85, 0.98]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.93, 1.06]
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.16</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.25]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Depression
</td>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>0.89</strong>
</td>
<td style="text-align:center;">
<strong>[0.83, 0.96]</strong>
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.91, 1.04]
</td>
<td style="text-align:center;">
<strong>0.76</strong>
</td>
<td style="text-align:center;">
<strong>[0.68, 0.84]</strong>
</td>
<td style="text-align:center;">
<strong>1.12</strong>
</td>
<td style="text-align:center;">
<strong>[1.05, 1.21]</strong>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Bold values indicate terms whose confidence intervals did not overlap with 0
</td>
</tr>
</tfoot>
</table>
<p>So this looks pretty good, except that it’s annoying how the Trait name is repeated five times. This is where we’ll use <code>collapse_rows()</code>.</p>
<pre class="r code-style"><code>tidy3 %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, &quot;r&quot;, rep(&quot;c&quot;, 8)),
        col.names = c(&quot;Trait&quot;, &quot;Covariate&quot;, rep(c(&quot;OR&quot;, &quot;CI&quot;), times = 4)),
        caption = &quot;&lt;strong&gt;Table 3&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Estimated Personality-Outcome Associations&lt;/em&gt;&quot;) %&gt;%
  kable_styling(full_width = F) %&gt;%
  collapse_rows(1, valign = &quot;top&quot;) %&gt;%
  add_header_above(heads) %&gt;%
  add_footnote(label = &quot;Bold values indicate terms whose confidence intervals did not overlap with 0&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-42">Table 5: </span><strong>Table 3</strong><br><em>Estimated Personality-Outcome Associations</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Move in with Partner
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Married
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Divorced
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:right;">
Covariate
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Negative Affect
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.47]</strong>
</td>
<td style="text-align:center;">
<strong>1.29</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.40]</strong>
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.38, 1.80]</strong>
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>1.20</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.33]</strong>
</td>
<td style="text-align:center;">
<strong>1.17</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.27]</strong>
</td>
<td style="text-align:center;">
<strong>1.51</strong>
</td>
<td style="text-align:center;">
<strong>[1.32, 1.73]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.90, 1.09]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.42, 1.75]</strong>
</td>
<td style="text-align:center;">
<strong>1.53</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.66]</strong>
</td>
<td style="text-align:center;">
<strong>1.70</strong>
</td>
<td style="text-align:center;">
<strong>[1.48, 1.95]</strong>
</td>
<td style="text-align:center;">
<strong>1.39</strong>
</td>
<td style="text-align:center;">
<strong>[1.26, 1.53]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>1.34</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.48]</strong>
</td>
<td style="text-align:center;">
<strong>1.30</strong>
</td>
<td style="text-align:center;">
<strong>[1.20, 1.41]</strong>
</td>
<td style="text-align:center;">
<strong>1.59</strong>
</td>
<td style="text-align:center;">
<strong>[1.39, 1.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.11</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>1.35</strong>
</td>
<td style="text-align:center;">
<strong>[1.22, 1.49]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.43]</strong>
</td>
<td style="text-align:center;">
<strong>1.61</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.84]</strong>
</td>
<td style="text-align:center;">
<strong>1.12</strong>
</td>
<td style="text-align:center;">
<strong>[1.02, 1.22]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Positive Affect
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>1.36</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.52]</strong>
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.49, 1.78]</strong>
</td>
<td style="text-align:center;">
<strong>0.85</strong>
</td>
<td style="text-align:center;">
<strong>[0.74, 0.97]</strong>
</td>
<td style="text-align:center;">
<strong>1.97</strong>
</td>
<td style="text-align:center;">
<strong>[1.77, 2.20]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.11
</td>
<td style="text-align:center;">
[0.99, 1.24]
</td>
<td style="text-align:center;">
<strong>1.35</strong>
</td>
<td style="text-align:center;">
<strong>[1.23, 1.48]</strong>
</td>
<td style="text-align:center;">
<strong>0.77</strong>
</td>
<td style="text-align:center;">
<strong>[0.68, 0.89]</strong>
</td>
<td style="text-align:center;">
<strong>1.61</strong>
</td>
<td style="text-align:center;">
<strong>[1.44, 1.80]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.16</strong>
</td>
<td style="text-align:center;">
<strong>[1.03, 1.31]</strong>
</td>
<td style="text-align:center;">
<strong>1.42</strong>
</td>
<td style="text-align:center;">
<strong>[1.29, 1.56]</strong>
</td>
<td style="text-align:center;">
<strong>0.79</strong>
</td>
<td style="text-align:center;">
<strong>[0.68, 0.91]</strong>
</td>
<td style="text-align:center;">
<strong>1.61</strong>
</td>
<td style="text-align:center;">
<strong>[1.44, 1.81]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>1.35</strong>
</td>
<td style="text-align:center;">
<strong>[1.21, 1.52]</strong>
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.49, 1.78]</strong>
</td>
<td style="text-align:center;">
<strong>0.85</strong>
</td>
<td style="text-align:center;">
<strong>[0.74, 0.97]</strong>
</td>
<td style="text-align:center;">
<strong>1.96</strong>
</td>
<td style="text-align:center;">
<strong>[1.76, 2.19]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>1.31</strong>
</td>
<td style="text-align:center;">
<strong>[1.17, 1.47]</strong>
</td>
<td style="text-align:center;">
<strong>1.55</strong>
</td>
<td style="text-align:center;">
<strong>[1.42, 1.70]</strong>
</td>
<td style="text-align:center;">
<strong>0.87</strong>
</td>
<td style="text-align:center;">
<strong>[0.75, 1.00]</strong>
</td>
<td style="text-align:center;">
<strong>1.87</strong>
</td>
<td style="text-align:center;">
<strong>[1.68, 2.09]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Self-Esteem
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.88, 1.13]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.94]</strong>
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.81, 1.12]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.07
</td>
<td style="text-align:center;">
[0.94, 1.22]
</td>
<td style="text-align:center;">
<strong>0.90</strong>
</td>
<td style="text-align:center;">
<strong>[0.83, 0.99]</strong>
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.82, 1.15]
</td>
<td style="text-align:center;">
<strong>1.18</strong>
</td>
<td style="text-align:center;">
<strong>[1.05, 1.33]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
0.94
</td>
<td style="text-align:center;">
[0.83, 1.07]
</td>
<td style="text-align:center;">
<strong>0.79</strong>
</td>
<td style="text-align:center;">
<strong>[0.73, 0.87]</strong>
</td>
<td style="text-align:center;">
0.92
</td>
<td style="text-align:center;">
[0.78, 1.09]
</td>
<td style="text-align:center;">
0.98
</td>
<td style="text-align:center;">
[0.87, 1.10]
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.88, 1.13]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.94]</strong>
</td>
<td style="text-align:center;">
0.94
</td>
<td style="text-align:center;">
[0.81, 1.12]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.98, 1.23]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.87, 1.12]
</td>
<td style="text-align:center;">
<strong>0.86</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.93]</strong>
</td>
<td style="text-align:center;">
0.96
</td>
<td style="text-align:center;">
[0.82, 1.15]
</td>
<td style="text-align:center;">
1.08
</td>
<td style="text-align:center;">
[0.97, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Optimism
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.79]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.46]</strong>
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
[0.93, 1.30]
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.88]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>1.23</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.41]</strong>
</td>
<td style="text-align:center;">
1.08
</td>
<td style="text-align:center;">
[0.97, 1.20]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.85, 1.19]
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.18, 1.50]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.33</strong>
</td>
<td style="text-align:center;">
<strong>[1.17, 1.51]</strong>
</td>
<td style="text-align:center;">
1.11
</td>
<td style="text-align:center;">
[1.00, 1.24]
</td>
<td style="text-align:center;">
1.04
</td>
<td style="text-align:center;">
[0.87, 1.24]
</td>
<td style="text-align:center;">
<strong>1.31</strong>
</td>
<td style="text-align:center;">
<strong>[1.16, 1.48]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>1.58</strong>
</td>
<td style="text-align:center;">
<strong>[1.40, 1.79]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.46]</strong>
</td>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
[0.93, 1.30]
</td>
<td style="text-align:center;">
<strong>1.68</strong>
</td>
<td style="text-align:center;">
<strong>[1.50, 1.89]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>1.50</strong>
</td>
<td style="text-align:center;">
<strong>[1.32, 1.70]</strong>
</td>
<td style="text-align:center;">
<strong>1.32</strong>
</td>
<td style="text-align:center;">
<strong>[1.19, 1.47]</strong>
</td>
<td style="text-align:center;">
1.07
</td>
<td style="text-align:center;">
[0.90, 1.27]
</td>
<td style="text-align:center;">
<strong>1.63</strong>
</td>
<td style="text-align:center;">
<strong>[1.45, 1.83]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Depression
</td>
<td style="text-align:right;">
None
</td>
<td style="text-align:center;">
<strong>0.91</strong>
</td>
<td style="text-align:center;">
<strong>[0.85, 0.98]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.93, 1.06]
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.15</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.24]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>0.88</strong>
</td>
<td style="text-align:center;">
<strong>[0.81, 0.95]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.92, 1.06]
</td>
<td style="text-align:center;">
<strong>0.73</strong>
</td>
<td style="text-align:center;">
<strong>[0.66, 0.80]</strong>
</td>
<td style="text-align:center;">
<strong>1.16</strong>
</td>
<td style="text-align:center;">
<strong>[1.07, 1.25]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>0.63</strong>
</td>
<td style="text-align:center;">
<strong>[0.59, 0.69]</strong>
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.69, 0.80]</strong>
</td>
<td style="text-align:center;">
<strong>0.63</strong>
</td>
<td style="text-align:center;">
<strong>[0.56, 0.70]</strong>
</td>
<td style="text-align:center;">
<strong>0.77</strong>
</td>
<td style="text-align:center;">
<strong>[0.71, 0.83]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender
</td>
<td style="text-align:center;">
<strong>0.91</strong>
</td>
<td style="text-align:center;">
<strong>[0.85, 0.98]</strong>
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.93, 1.06]
</td>
<td style="text-align:center;">
<strong>0.74</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.82]</strong>
</td>
<td style="text-align:center;">
<strong>1.16</strong>
</td>
<td style="text-align:center;">
<strong>[1.08, 1.25]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education
</td>
<td style="text-align:center;">
<strong>0.89</strong>
</td>
<td style="text-align:center;">
<strong>[0.83, 0.96]</strong>
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.91, 1.04]
</td>
<td style="text-align:center;">
<strong>0.76</strong>
</td>
<td style="text-align:center;">
<strong>[0.68, 0.84]</strong>
</td>
<td style="text-align:center;">
<strong>1.12</strong>
</td>
<td style="text-align:center;">
<strong>[1.05, 1.21]</strong>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Bold values indicate terms whose confidence intervals did not overlap with 0
</td>
</tr>
</tfoot>
</table>
<p>That’s a pretty good-looking table!</p>
</div>
</div>
<div id="moderators" class="section level2">
<h2>Moderators</h2>
<p>All right, time to introduce a moderator!</p>
<p>The procedure for this is going to be very close to above, with the main change being that the key term will no longer be p_value but p_value:moderator.</p>
<p>But first, the set up<br />
### Set up Data<br />
This time, we need to add a new grouping variable – namely, the target moderators. We aren’t going to include the “none” condition here, as we assume we’ve already tested and presented those results separately.</p>
<pre class="r code-style"><code>gsoep_nested4 &lt;- gsoep_long %&gt;%
  group_by(Trait, Outcome, Covariate) %&gt;%
  nest() %&gt;%
  ungroup() %&gt;%
  arrange(Outcome, Trait, Covariate)
gsoep_nested4</code></pre>
<pre><code>## # A tibble: 80 x 4
##    Outcome  Trait  Covariate data                 
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;               
##  1 chldbrth DEP    age       &lt;tibble [28,634 × 4]&gt;
##  2 chldbrth DEP    gender    &lt;tibble [28,634 × 4]&gt;
##  3 chldbrth DEP    parEdu    &lt;tibble [28,634 × 4]&gt;
##  4 chldbrth DEP    SRhealth  &lt;tibble [28,634 × 4]&gt;
##  5 chldbrth NegAff age       &lt;tibble [16,992 × 4]&gt;
##  6 chldbrth NegAff gender    &lt;tibble [16,992 × 4]&gt;
##  7 chldbrth NegAff parEdu    &lt;tibble [16,992 × 4]&gt;
##  8 chldbrth NegAff SRhealth  &lt;tibble [16,992 × 4]&gt;
##  9 chldbrth OP     age       &lt;tibble [9,192 × 4]&gt; 
## 10 chldbrth OP     gender    &lt;tibble [9,192 × 4]&gt; 
## # … with 70 more rows</code></pre>
<div id="run-the-models-2" class="section level3">
<h3>Run the models</h3>
<pre class="r code-style"><code>factor_fun &lt;- function(x){if(is.numeric(x)){diff(range(x, na.rm = T)) %in% 1:2 &amp; length(unique(x)) &lt;= 4} else{F}}

mod4_fun &lt;- function(d, cov){
  d$o_value &lt;- factor(d$o_value)
  d &lt;- d %&gt;% mutate_if(factor_fun, factor)
  if(cov == &quot;none&quot;){f &lt;- formula(o_value ~ p_value)} else{f &lt;- formula(o_value ~ p_value* c_value)}
  glm(f, data = d, family = binomial(link = &quot;logit&quot;))
}

gsoep_nested4 &lt;- gsoep_nested4 %&gt;%
  mutate(m = map2(data, Covariate, mod4_fun),
         tidy = map(m, ~tidy(., conf.int = T)))
gsoep_nested4</code></pre>
<pre><code>## # A tibble: 80 x 6
##    Outcome  Trait  Covariate data                  m      tidy            
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;                &lt;list&gt; &lt;list&gt;          
##  1 chldbrth DEP    age       &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  2 chldbrth DEP    gender    &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  3 chldbrth DEP    parEdu    &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [6 × 7]&gt;
##  4 chldbrth DEP    SRhealth  &lt;tibble [28,634 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  5 chldbrth NegAff age       &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  6 chldbrth NegAff gender    &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  7 chldbrth NegAff parEdu    &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [6 × 7]&gt;
##  8 chldbrth NegAff SRhealth  &lt;tibble [16,992 × 4]&gt; &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
##  9 chldbrth OP     age       &lt;tibble [9,192 × 4]&gt;  &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
## 10 chldbrth OP     gender    &lt;tibble [9,192 × 4]&gt;  &lt;glm&gt;  &lt;tibble [4 × 7]&gt;
## # … with 70 more rows</code></pre>
<p>Like before, we are going to have different numbers of rows. Again this is good becuase it means that the appropriate moderators and main effects were added.</p>
</div>
<div id="create-the-table-2" class="section level3">
<h3>Create the Table</h3>
<pre class="r code-style"><code>tidy4 &lt;- gsoep_nested4 %&gt;%
  select(Outcome, Trait, Moderator = Covariate, tidy) %&gt;%
  unnest(tidy)
tidy4</code></pre>
<pre><code>## # A tibble: 360 x 10
##    Outcome  Trait Moderator term  estimate std.error statistic  p.value conf.low
##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1 chldbrth DEP   age       (Int… -4.16      0.226     -18.4   9.00e-76 -4.61   
##  2 chldbrth DEP   age       p_va…  0.172     0.0560      3.06  2.19e- 3  0.0630 
##  3 chldbrth DEP   age       c_va… -0.0725    0.00987    -7.35  1.95e-13 -0.0921 
##  4 chldbrth DEP   age       p_va…  0.00157   0.00245     0.643 5.20e- 1 -0.00320
##  5 chldbrth DEP   gender    (Int… -3.47      0.228     -15.2   2.05e-52 -3.93   
##  6 chldbrth DEP   gender    p_va…  0.128     0.0558      2.29  2.21e- 2  0.0194 
##  7 chldbrth DEP   gender    c_va… -0.0475    0.298      -0.160 8.73e- 1 -0.630  
##  8 chldbrth DEP   gender    p_va…  0.0406    0.0740      0.548 5.84e- 1 -0.105  
##  9 chldbrth DEP   parEdu    (Int… -3.63      0.177     -20.5   9.15e-94 -3.98   
## 10 chldbrth DEP   parEdu    p_va…  0.154     0.0441      3.49  4.90e- 4  0.0680 
## # … with 350 more rows, and 1 more variable: conf.high &lt;dbl&gt;</code></pre>
<p>The basic steps from here are similar: filter target terms, index significance, exponentiate, format values, create CI’s, bold significance, select needed columns.</p>
<p>We do need to a bit of work on how we index our moderators. Specifically, for the factor variables, we want to make sure we indicate what the levels are.</p>
<pre class="r code-style"><code>tidy4 &lt;- tidy4 %&gt;%
  filter(grepl(&quot;p_value:&quot;, term)) %&gt;%
  mutate(term = str_replace(term, &quot;c_value&quot;, Moderator),
         Moderator = str_remove(term, &quot;p_value:&quot;),
         sig = ifelse(sign(conf.low) == sign(conf.high), &quot;sig&quot;, &quot;ns&quot;)) %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), exp) %&gt;%
  mutate_at(vars(estimate, conf.low, conf.high), ~sprintf(&quot;%.2f&quot;, .)) %&gt;%
  mutate(CI = sprintf(&quot;[%s, %s]&quot;, conf.low, conf.high)) %&gt;%
  mutate_at(vars(estimate, CI), ~ifelse(sig == &quot;sig&quot;, sprintf(&quot;&lt;strong&gt;%s&lt;/strong&gt;&quot;, .), .)) %&gt;%
  select(Outcome, Trait, Moderator, OR = estimate, CI)</code></pre>
<p>Now we’re ready for the <code>pivot_longer()</code>, <code>unite()</code>, <code>pivot_wider()</code>, order columns (using <code>select()</code>) combo from before. The only difference is that I’m going to use <code>pivot_wider()</code> to do the uniting for me this time!</p>
<pre class="r code-style"><code>O_names &lt;- tibble(
  old = c(&quot;mvInPrtnr&quot;, &quot;married&quot;, &quot;divorced&quot;, &quot;chldbrth&quot;),
  new = c(&quot;Move in with Partner&quot;, &quot;Married&quot;, &quot;Divorced&quot;, &quot;Birth of a Child&quot;)
)
levs &lt;- paste(rep(O_names$old, each = 2), rep(c(&quot;OR&quot;,&quot;CI&quot;), times = 4), sep = &quot;_&quot;)

tidy4 &lt;- tidy4 %&gt;%
  pivot_longer(cols = c(OR, CI), names_to = &quot;est&quot;, values_to = &quot;value&quot;) %&gt;%
  pivot_wider(names_from = c(&quot;Outcome&quot;, &quot;est&quot;), values_from = &quot;value&quot;, names_sep = &quot;_&quot;) %&gt;%
  select(Trait, Moderator, all_of(levs))</code></pre>
<p>All right, time to use <code>kable()</code>! This will proceed almost exactly as the example with covariates, with the main difference being that our target term is now the interaction.</p>
<p>Given that we have multiple moderators, some of which have multiple levels, we’ll also want to order them. So we’ll make the Moderator column a factor as well. But we’ll do so after we’ve given our covariates nicer names. While we’re at it, we’ll go ahead and do the same things for our Trait column.</p>
<pre class="r code-style"><code>m_names &lt;- tibble(
  old = c(&quot;age&quot;, &quot;SRhealth&quot;, &quot;gender1&quot;, &quot;parEdu1&quot;, &quot;parEdu2&quot;),
  new = c(&quot;Age&quot;, &quot;Self-Rated Health&quot;, &quot;Gender (Female)&quot;, 
          &quot;Parental Education (College)&quot;, &quot;Parental Education (Beyond College)&quot;)
)

tidy4 &lt;- tidy4 %&gt;%
  mutate(Trait = mapvalues(Trait, from = p_names$old, to = p_names$new),
         Trait = factor(Trait, levels = p_names$new),
         Moderator = mapvalues(Moderator, from = m_names$old, to = m_names$new),
         Moderator = factor(Moderator, levels = m_names$new)) %&gt;%
  arrange(Trait, Moderator)</code></pre>
<p>And again, for our spanned columns, we’ll take advantage of our <code>O_names</code> object to create the vector in advance:</p>
<pre class="r code-style"><code>heads &lt;- rep(2, 5)
heads</code></pre>
<pre><code>## [1] 2 2 2 2 2</code></pre>
<pre class="r code-style"><code>names(heads) &lt;- c(&quot; &quot;, O_names$new)
heads</code></pre>
<pre><code>##                      Move in with Partner              Married 
##                    2                    2                    2 
##             Divorced     Birth of a Child 
##                    2                    2</code></pre>
<p>Now, this will proceed as before, including using <code>collapse_rows()</code>. The change this time will simply be to our table caption.</p>
<pre class="r code-style"><code>tidy4 %&gt;%
  kable(., escape = F,
        align = c(&quot;r&quot;, &quot;r&quot;, rep(&quot;c&quot;, 8)),
        col.names = c(&quot;Trait&quot;, &quot;Moderator&quot;, rep(c(&quot;OR&quot;, &quot;CI&quot;), times = 4)),
        caption = &quot;&lt;strong&gt;Table 4&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Estimated Moderators of Personality-Outcome Associations&lt;/em&gt;&quot;) %&gt;%
  kable_styling(full_width = F) %&gt;%
  collapse_rows(1, valign = &quot;top&quot;) %&gt;%
  add_header_above(heads) %&gt;%
  add_footnote(label = &quot;Bold values indicate terms whose confidence intervals did not overlap with 0&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-50">Table 6: </span><strong>Table 4</strong><br><em>Estimated Moderators of Personality-Outcome Associations</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Move in with Partner
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Married
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Divorced
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Birth of a Child
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Trait
</th>
<th style="text-align:right;">
Moderator
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
<th style="text-align:center;">
OR
</th>
<th style="text-align:center;">
CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Negative Affect
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.99, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.83, 1.09]
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.87, 1.09]
</td>
<td style="text-align:center;">
0.94
</td>
<td style="text-align:center;">
[0.80, 1.11]
</td>
<td style="text-align:center;">
0.91
</td>
<td style="text-align:center;">
[0.80, 1.05]
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender (Female)
</td>
<td style="text-align:center;">
1.07
</td>
<td style="text-align:center;">
[0.87, 1.31]
</td>
<td style="text-align:center;">
1.13
</td>
<td style="text-align:center;">
[0.96, 1.32]
</td>
<td style="text-align:center;">
0.77
</td>
<td style="text-align:center;">
[0.59, 1.01]
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.82, 1.20]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (College)
</td>
<td style="text-align:center;">
1.07
</td>
<td style="text-align:center;">
[0.85, 1.35]
</td>
<td style="text-align:center;">
0.83
</td>
<td style="text-align:center;">
[0.69, 1.00]
</td>
<td style="text-align:center;">
1.13
</td>
<td style="text-align:center;">
[0.76, 1.65]
</td>
<td style="text-align:center;">
1.11
</td>
<td style="text-align:center;">
[0.89, 1.39]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (Beyond College)
</td>
<td style="text-align:center;">
0.85
</td>
<td style="text-align:center;">
[0.58, 1.22]
</td>
<td style="text-align:center;">
0.80
</td>
<td style="text-align:center;">
[0.55, 1.14]
</td>
<td style="text-align:center;">
1.39
</td>
<td style="text-align:center;">
[0.82, 2.33]
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.76, 1.56]
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Positive Affect
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
<strong>0.99</strong>
</td>
<td style="text-align:center;">
<strong>[0.99, 1.00]</strong>
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
<td style="text-align:center;">
<strong>1.01</strong>
</td>
<td style="text-align:center;">
<strong>[1.00, 1.02]</strong>
</td>
<td style="text-align:center;">
<strong>1.01</strong>
</td>
<td style="text-align:center;">
<strong>[1.00, 1.02]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
<strong>1.22</strong>
</td>
<td style="text-align:center;">
<strong>[1.06, 1.40]</strong>
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.83, 1.07]
</td>
<td style="text-align:center;">
1.01
</td>
<td style="text-align:center;">
[0.85, 1.19]
</td>
<td style="text-align:center;">
0.92
</td>
<td style="text-align:center;">
[0.78, 1.08]
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender (Female)
</td>
<td style="text-align:center;">
1.09
</td>
<td style="text-align:center;">
[0.87, 1.37]
</td>
<td style="text-align:center;">
1.16
</td>
<td style="text-align:center;">
[0.97, 1.39]
</td>
<td style="text-align:center;">
1.13
</td>
<td style="text-align:center;">
[0.86, 1.48]
</td>
<td style="text-align:center;">
<strong>1.26</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.57]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (College)
</td>
<td style="text-align:center;">
0.92
</td>
<td style="text-align:center;">
[0.71, 1.20]
</td>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
[0.71, 1.10]
</td>
<td style="text-align:center;">
0.98
</td>
<td style="text-align:center;">
[0.65, 1.49]
</td>
<td style="text-align:center;">
0.93
</td>
<td style="text-align:center;">
[0.71, 1.22]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (Beyond College)
</td>
<td style="text-align:center;">
1.06
</td>
<td style="text-align:center;">
[0.70, 1.63]
</td>
<td style="text-align:center;">
1.14
</td>
<td style="text-align:center;">
[0.75, 1.78]
</td>
<td style="text-align:center;">
<strong>0.47</strong>
</td>
<td style="text-align:center;">
<strong>[0.28, 0.79]</strong>
</td>
<td style="text-align:center;">
<strong>0.49</strong>
</td>
<td style="text-align:center;">
<strong>[0.34, 0.73]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Self-Esteem
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.99, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.99, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.99, 1.01]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
1.03
</td>
<td style="text-align:center;">
[0.86, 1.21]
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.88, 1.11]
</td>
<td style="text-align:center;">
1.13
</td>
<td style="text-align:center;">
[0.92, 1.35]
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.83, 1.17]
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender (Female)
</td>
<td style="text-align:center;">
<strong>0.77</strong>
</td>
<td style="text-align:center;">
<strong>[0.59, 0.99]</strong>
</td>
<td style="text-align:center;">
0.90
</td>
<td style="text-align:center;">
[0.76, 1.07]
</td>
<td style="text-align:center;">
1.15
</td>
<td style="text-align:center;">
[0.83, 1.60]
</td>
<td style="text-align:center;">
<strong>0.73</strong>
</td>
<td style="text-align:center;">
<strong>[0.57, 0.94]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (College)
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.73, 1.32]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.83, 1.21]
</td>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
[0.59, 1.36]
</td>
<td style="text-align:center;">
0.91
</td>
<td style="text-align:center;">
[0.71, 1.18]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (Beyond College)
</td>
<td style="text-align:center;">
0.95
</td>
<td style="text-align:center;">
[0.62, 1.53]
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.65, 1.51]
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.82
</td>
<td style="text-align:center;">
[0.51, 1.43]
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Optimism
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[0.99, 1.01]
</td>
<td style="text-align:center;">
<strong>1.01</strong>
</td>
<td style="text-align:center;">
<strong>[1.00, 1.01]</strong>
</td>
<td style="text-align:center;">
1.01
</td>
<td style="text-align:center;">
[1.00, 1.02]
</td>
<td style="text-align:center;">
<strong>1.02</strong>
</td>
<td style="text-align:center;">
<strong>[1.01, 1.02]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
0.89
</td>
<td style="text-align:center;">
[0.74, 1.05]
</td>
<td style="text-align:center;">
0.93
</td>
<td style="text-align:center;">
[0.81, 1.07]
</td>
<td style="text-align:center;">
1.01
</td>
<td style="text-align:center;">
[0.82, 1.24]
</td>
<td style="text-align:center;">
<strong>0.77</strong>
</td>
<td style="text-align:center;">
<strong>[0.65, 0.92]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender (Female)
</td>
<td style="text-align:center;">
1.03
</td>
<td style="text-align:center;">
[0.81, 1.32]
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.79, 1.18]
</td>
<td style="text-align:center;">
1.06
</td>
<td style="text-align:center;">
[0.76, 1.48]
</td>
<td style="text-align:center;">
1.06
</td>
<td style="text-align:center;">
[0.84, 1.33]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (College)
</td>
<td style="text-align:center;">
0.91
</td>
<td style="text-align:center;">
[0.68, 1.24]
</td>
<td style="text-align:center;">
0.85
</td>
<td style="text-align:center;">
[0.65, 1.13]
</td>
<td style="text-align:center;">
0.74
</td>
<td style="text-align:center;">
[0.44, 1.25]
</td>
<td style="text-align:center;">
1.04
</td>
<td style="text-align:center;">
[0.76, 1.42]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (Beyond College)
</td>
<td style="text-align:center;">
1.03
</td>
<td style="text-align:center;">
[0.62, 1.75]
</td>
<td style="text-align:center;">
1.30
</td>
<td style="text-align:center;">
[0.82, 2.15]
</td>
<td style="text-align:center;">
1.73
</td>
<td style="text-align:center;">
[0.78, 4.28]
</td>
<td style="text-align:center;">
0.77
</td>
<td style="text-align:center;">
[0.51, 1.19]
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Depression
</td>
<td style="text-align:right;">
Age
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
<td style="text-align:center;">
<strong>1.01</strong>
</td>
<td style="text-align:center;">
<strong>[1.00, 1.01]</strong>
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
<td style="text-align:center;">
1.00
</td>
<td style="text-align:center;">
[1.00, 1.01]
</td>
</tr>
<tr>
<td style="text-align:right;">
Self-Rated Health
</td>
<td style="text-align:center;">
0.97
</td>
<td style="text-align:center;">
[0.89, 1.06]
</td>
<td style="text-align:center;">
<strong>0.87</strong>
</td>
<td style="text-align:center;">
<strong>[0.80, 0.95]</strong>
</td>
<td style="text-align:center;">
0.91
</td>
<td style="text-align:center;">
[0.80, 1.02]
</td>
<td style="text-align:center;">
<strong>0.88</strong>
</td>
<td style="text-align:center;">
<strong>[0.79, 0.97]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gender (Female)
</td>
<td style="text-align:center;">
1.05
</td>
<td style="text-align:center;">
[0.91, 1.21]
</td>
<td style="text-align:center;">
1.03
</td>
<td style="text-align:center;">
[0.91, 1.17]
</td>
<td style="text-align:center;">
1.21
</td>
<td style="text-align:center;">
[1.00, 1.48]
</td>
<td style="text-align:center;">
1.04
</td>
<td style="text-align:center;">
[0.90, 1.20]
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (College)
</td>
<td style="text-align:center;">
0.87
</td>
<td style="text-align:center;">
[0.73, 1.04]
</td>
<td style="text-align:center;">
0.94
</td>
<td style="text-align:center;">
[0.79, 1.10]
</td>
<td style="text-align:center;">
0.99
</td>
<td style="text-align:center;">
[0.73, 1.34]
</td>
<td style="text-align:center;">
<strong>0.80</strong>
</td>
<td style="text-align:center;">
<strong>[0.67, 0.96]</strong>
</td>
</tr>
<tr>
<td style="text-align:right;">
Parental Education (Beyond College)
</td>
<td style="text-align:center;">
1.05
</td>
<td style="text-align:center;">
[0.80, 1.40]
</td>
<td style="text-align:center;">
1.06
</td>
<td style="text-align:center;">
[0.80, 1.43]
</td>
<td style="text-align:center;">
0.85
</td>
<td style="text-align:center;">
[0.56, 1.33]
</td>
<td style="text-align:center;">
1.12
</td>
<td style="text-align:center;">
[0.84, 1.52]
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Bold values indicate terms whose confidence intervals did not overlap with 0
</td>
</tr>
</tfoot>
</table>
</div>
</div>
<div id="simple-effects" class="section level2">
<h2>Simple Effects</h2>
<p>With moderator analyses, we typically need to unpack the results and present them as simple effects. In many cases, plots are super useful. I demonstrated how to make simple effects plots in the <code>purrr</code> tutorial, so check there for more!</p>
<p>We’re going to start here with our same nested data frame from the previous example. We’ll basically want to get estimates of the personality-outcome associations for different levels of our factor or continuous moderators.</p>
<p>To do this, we’ll use the <code>predict()</code> functions.</p>
<p>** In progress **</p>
</div>
</div>
<div id="other-lessons" class="section level1">
<h1>Other Lessons</h1>
<div id="descriptives" class="section level2">
<h2>Descriptives</h2>
<p>Descriptives tables are slightly tricky to add generalizable code for becuase the needs of those tables vary. Below, I’m going to give some code for a couple of basic descriptive tables I’d be likely to include for a paper looking at predictive personality-outcome associations.</p>
<p>First, one indexing demographic characteristics and samples sizes. Second, one indexing means and standard deviations. Then finally wrapping up with a correlation table of study measures.</p>
<div id="demographic-charateristics" class="section level3">
<h3>Demographic Charateristics</h3>
<p>First, let’s look at demographic characteristics, including sample sizes, age, and gender.</p>
<p>Because I’m interested in events, I’m going to specifically look at sample sizes of those who did and did experience events as well as any gender or age differences.</p>
<pre class="r code-style"><code>gsoep %&gt;%
  select(p_year, SID, Outcome, o_value, gender, age) %&gt;%
  group_by(p_year, Outcome, o_value) %&gt;%
  summarize(N = n(), 
            Female = sum(gender, na.rm = T), 
            Age = mean(age, na.rm = T), 
            SD_Age = sd(age, na.rm = T)) %&gt;%
  ungroup() %&gt;%
  pivot_longer(cols = N:SD_Age, names_to = &quot;measure&quot;, values_to = &quot;value&quot;) %&gt;%
  pivot_wider(names_from = c(&quot;measure&quot;, &quot;o_value&quot;), values_from = &quot;value&quot;,
              names_sep = &quot;_&quot;) %&gt;%
  mutate(N = sprintf(&quot;%s (%s)&quot;, N_1, N_0),
         `% Female` = sprintf(&quot;%.2f (%.2f)&quot;, Female_1/N_1*100, Female_0/N_0*100),
         `Mean` = sprintf(&quot;%.1f (%.1f)&quot;, Age_1, Age_0),
         `SD` = sprintf(&quot;%.1f (%.1f)&quot;, SD_Age_1, SD_Age_0),
         Outcome = mapvalues(Outcome, O_names$old, O_names$new),
         Outcome = factor(Outcome, levels = O_names$new)) %&gt;%
  select(Outcome, Year = p_year, N:`SD`) %&gt;%
  arrange(Outcome, Year) %&gt;%
  kable(., escape = F,
        caption = &quot;&lt;strong&gt;Table 7&lt;/strong&gt;&lt;br&gt;&lt;em&gt;Descriptive Statistics of Those Who Experienced Outcomes versus Those Who Did Not&quot;,
        align = c(&quot;r&quot;, &quot;r&quot;, rep(&quot;c&quot;, 4))) %&gt;%
  kable_styling(full_width = F) %&gt;%
  add_header_above(c(&quot; &quot; = 4, &quot;Age&quot; = 2)) %&gt;%
  collapse_rows(1, &quot;top&quot;) %&gt;%
  add_footnote(label = &quot;Values in parentheses indicate demographics of those who did not experience outcomes after the noted year&quot;, notation = &quot;none&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-51">Table 7: </span><strong>Table 7</strong><br><em>Descriptive Statistics of Those Who Experienced Outcomes versus Those Who Did Not</em>
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="4">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Age
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Outcome
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:center;">
N
</th>
<th style="text-align:center;">
% Female
</th>
<th style="text-align:center;">
Mean
</th>
<th style="text-align:center;">
SD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Move in with Partner
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:center;">
734 (10381)
</td>
<td style="text-align:center;">
52.72 (51.61)
</td>
<td style="text-align:center;">
21.5 (41.4)
</td>
<td style="text-align:center;">
12.6 (17.8)
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:center;">
460 (8802)
</td>
<td style="text-align:center;">
54.35 (52.08)
</td>
<td style="text-align:center;">
18.8 (39.6)
</td>
<td style="text-align:center;">
12.4 (18.2)
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:center;">
433 (9387)
</td>
<td style="text-align:center;">
53.58 (52.43)
</td>
<td style="text-align:center;">
20.8 (41.2)
</td>
<td style="text-align:center;">
13.8 (18.2)
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:center;">
671 (17433)
</td>
<td style="text-align:center;">
55.14 (52.41)
</td>
<td style="text-align:center;">
20.1 (40.4)
</td>
<td style="text-align:center;">
13.9 (18.3)
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:center;">
626 (31164)
</td>
<td style="text-align:center;">
50.32 (52.14)
</td>
<td style="text-align:center;">
21.3 (40.7)
</td>
<td style="text-align:center;">
15.1 (18.9)
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Married
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:center;">
837 (10309)
</td>
<td style="text-align:center;">
52.21 (51.14)
</td>
<td style="text-align:center;">
24.3 (41.0)
</td>
<td style="text-align:center;">
12.3 (18.1)
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:center;">
632 (8766)
</td>
<td style="text-align:center;">
51.58 (51.87)
</td>
<td style="text-align:center;">
23.2 (39.1)
</td>
<td style="text-align:center;">
12.8 (18.6)
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:center;">
602 (9370)
</td>
<td style="text-align:center;">
51.00 (52.27)
</td>
<td style="text-align:center;">
24.1 (40.8)
</td>
<td style="text-align:center;">
13.2 (18.6)
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:center;">
1042 (17410)
</td>
<td style="text-align:center;">
51.06 (52.19)
</td>
<td style="text-align:center;">
22.9 (40.0)
</td>
<td style="text-align:center;">
13.5 (18.6)
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:center;">
1210 (31095)
</td>
<td style="text-align:center;">
52.73 (52.00)
</td>
<td style="text-align:center;">
19.9 (40.6)
</td>
<td style="text-align:center;">
14.7 (19.0)
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Divorced
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:center;">
320 (11374)
</td>
<td style="text-align:center;">
53.12 (51.70)
</td>
<td style="text-align:center;">
31.4 (39.6)
</td>
<td style="text-align:center;">
11.5 (18.3)
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:center;">
216 (9924)
</td>
<td style="text-align:center;">
52.78 (52.19)
</td>
<td style="text-align:center;">
30.1 (37.5)
</td>
<td style="text-align:center;">
10.7 (18.6)
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:center;">
204 (10564)
</td>
<td style="text-align:center;">
53.43 (52.52)
</td>
<td style="text-align:center;">
31.3 (39.0)
</td>
<td style="text-align:center;">
11.7 (18.7)
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:center;">
360 (19822)
</td>
<td style="text-align:center;">
54.44 (52.52)
</td>
<td style="text-align:center;">
30.7 (38.2)
</td>
<td style="text-align:center;">
11.8 (18.7)
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:center;">
336 (35446)
</td>
<td style="text-align:center;">
52.38 (52.34)
</td>
<td style="text-align:center;">
31.1 (38.6)
</td>
<td style="text-align:center;">
12.4 (19.1)
</td>
</tr>
<tr>
<td style="text-align:right;vertical-align: top !important;" rowspan="5">
Birth of a Child
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:center;">
779 (10153)
</td>
<td style="text-align:center;">
53.02 (51.62)
</td>
<td style="text-align:center;">
21.9 (41.9)
</td>
<td style="text-align:center;">
10.2 (17.9)
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:center;">
543 (8649)
</td>
<td style="text-align:center;">
54.51 (51.95)
</td>
<td style="text-align:center;">
20.4 (40.0)
</td>
<td style="text-align:center;">
10.7 (18.4)
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:center;">
483 (9264)
</td>
<td style="text-align:center;">
54.66 (52.29)
</td>
<td style="text-align:center;">
21.1 (41.6)
</td>
<td style="text-align:center;">
11.0 (18.4)
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:center;">
795 (17267)
</td>
<td style="text-align:center;">
52.83 (52.30)
</td>
<td style="text-align:center;">
20.8 (40.8)
</td>
<td style="text-align:center;">
11.3 (18.5)
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:center;">
821 (30967)
</td>
<td style="text-align:center;">
57.25 (52.02)
</td>
<td style="text-align:center;">
19.5 (41.2)
</td>
<td style="text-align:center;">
12.3 (18.9)
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup></sup> Values in parentheses indicate demographics of those who did not experience outcomes after the noted year
</td>
</tr>
</tfoot>
</table>
</div>
<div id="means-and-standard-deviations" class="section level3">
<h3>Means and Standard Deviations</h3>
</div>
<div id="zero-order-correlations" class="section level3">
<h3>Zero-Order Correlations</h3>
</div>
</div>
</div>
